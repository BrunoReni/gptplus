#INCLUDE "BADEFINITION.CH"

NEW ENTITY ITEMCONTABIL

//-------------------------------------------------------------------
/*/{Protheus.doc} BAItemContabil
Visualiza as informacoes sobre Itens Contabil.              

@author  Andreia Lima
@since   12/03/2018
/*/
//-------------------------------------------------------------------
Class BAItemContabil from BAEntity
	Method Setup( ) CONSTRUCTOR
	Method BuildQuery()
EndClass

//-------------------------------------------------------------------
/*/{Protheus.doc} New  
Construtor padrao.  

@author  Andreia Lima
@since   12/03/2018
/*/
//-------------------------------------------------------------------  
Method Setup() class BAItemContabil
	_Super:Setup("ItemContabil", DIMENSION, "CTD" )
Return Self

//-------------------------------------------------------------------
/*/{Protheus.doc} BuildQuery
Constroi a query da entidade.
@return cQuery, string, query a ser processada.

@author  Andreia Lima
@since   12/03/2018
/*/
//------------------------------------------------------------------- 
Method BuildQuery() class BAItemContabil
	Local cQuery := ""

	cQuery += " SELECT "  
	cQuery += " CASE "
	cQuery += "		WHEN CTD11.CTD_ITEM IS NOT NULL THEN <<KEY_CTD_CTD11.CTD_FILIAL+CTD11.CTD_ITEM>>"
	cQuery += "		WHEN CTD10.CTD_ITEM IS NOT NULL THEN <<KEY_CTD_CTD10.CTD_FILIAL+CTD10.CTD_ITEM>>"
	cQuery += "		WHEN CTD9.CTD_ITEM IS NOT NULL THEN <<KEY_CTD_CTD9.CTD_FILIAL+CTD9.CTD_ITEM>>"
	cQuery += "		WHEN CTD8.CTD_ITEM IS NOT NULL THEN <<KEY_CTD_CTD8.CTD_FILIAL+CTD8.CTD_ITEM>>"
	cQuery += "		WHEN CTD7.CTD_ITEM IS NOT NULL THEN <<KEY_CTD_CTD7.CTD_FILIAL+CTD7.CTD_ITEM>>"
	cQuery += "		WHEN CTD6.CTD_ITEM IS NOT NULL THEN <<KEY_CTD_CTD6.CTD_FILIAL+CTD6.CTD_ITEM>>"
	cQuery += "		WHEN CTD5.CTD_ITEM IS NOT NULL THEN <<KEY_CTD_CTD5.CTD_FILIAL+CTD5.CTD_ITEM>>"
	cQuery += "		WHEN CTD4.CTD_ITEM IS NOT NULL THEN <<KEY_CTD_CTD4.CTD_FILIAL+CTD4.CTD_ITEM>>"
	cQuery += "		WHEN CTD3.CTD_ITEM IS NOT NULL THEN <<KEY_CTD_CTD3.CTD_FILIAL+CTD3.CTD_ITEM>>"
	cQuery += "		WHEN CTD2.CTD_ITEM IS NOT NULL THEN <<KEY_CTD_CTD2.CTD_FILIAL+CTD2.CTD_ITEM>>"
	cQuery += "		ELSE <<KEY_CTD_CTD1.CTD_FILIAL+CTD1.CTD_ITEM>>"
	cQuery += "	END AS BK_ITEM_CONTABIL11,"
	cQuery += "	CASE "
	cQuery += "		WHEN CTD10.CTD_ITEM IS NOT NULL THEN <<KEY_CTD_CTD10.CTD_FILIAL+CTD10.CTD_ITEM>>"
	cQuery += "		WHEN CTD9.CTD_ITEM IS NOT NULL THEN <<KEY_CTD_CTD9.CTD_FILIAL+CTD9.CTD_ITEM>>"
	cQuery += "		WHEN CTD8.CTD_ITEM IS NOT NULL THEN <<KEY_CTD_CTD8.CTD_FILIAL+CTD8.CTD_ITEM>>"
	cQuery += "		WHEN CTD7.CTD_ITEM IS NOT NULL THEN <<KEY_CTD_CTD7.CTD_FILIAL+CTD7.CTD_ITEM>>"
	cQuery += "		WHEN CTD6.CTD_ITEM IS NOT NULL THEN <<KEY_CTD_CTD6.CTD_FILIAL+CTD6.CTD_ITEM>>"
	cQuery += "		WHEN CTD5.CTD_ITEM IS NOT NULL THEN <<KEY_CTD_CTD5.CTD_FILIAL+CTD5.CTD_ITEM>>"
	cQuery += "		WHEN CTD4.CTD_ITEM IS NOT NULL THEN <<KEY_CTD_CTD4.CTD_FILIAL+CTD4.CTD_ITEM>>"
	cQuery += "		WHEN CTD3.CTD_ITEM IS NOT NULL THEN <<KEY_CTD_CTD3.CTD_FILIAL+CTD3.CTD_ITEM>>"
	cQuery += "		WHEN CTD2.CTD_ITEM IS NOT NULL THEN <<KEY_CTD_CTD2.CTD_FILIAL+CTD2.CTD_ITEM>>"
	cQuery += "		ELSE <<KEY_CTD_CTD1.CTD_FILIAL+CTD1.CTD_ITEM>>"
	cQuery += "	END AS BK_ITEM_CONTABIL10,"
	cQuery += "	CASE "
	cQuery += "		WHEN CTD9.CTD_ITEM IS NOT NULL THEN <<KEY_CTD_CTD9.CTD_FILIAL+CTD9.CTD_ITEM>>"
	cQuery += "		WHEN CTD8.CTD_ITEM IS NOT NULL THEN <<KEY_CTD_CTD8.CTD_FILIAL+CTD8.CTD_ITEM>>"
	cQuery += "		WHEN CTD7.CTD_ITEM IS NOT NULL THEN <<KEY_CTD_CTD7.CTD_FILIAL+CTD7.CTD_ITEM>>"
	cQuery += "		WHEN CTD6.CTD_ITEM IS NOT NULL THEN <<KEY_CTD_CTD6.CTD_FILIAL+CTD6.CTD_ITEM>>"
	cQuery += "		WHEN CTD5.CTD_ITEM IS NOT NULL THEN <<KEY_CTD_CTD5.CTD_FILIAL+CTD5.CTD_ITEM>>"
	cQuery += "		WHEN CTD4.CTD_ITEM IS NOT NULL THEN <<KEY_CTD_CTD4.CTD_FILIAL+CTD4.CTD_ITEM>>"
	cQuery += "		WHEN CTD3.CTD_ITEM IS NOT NULL THEN <<KEY_CTD_CTD3.CTD_FILIAL+CTD3.CTD_ITEM>>"
	cQuery += "		WHEN CTD2.CTD_ITEM IS NOT NULL THEN <<KEY_CTD_CTD2.CTD_FILIAL+CTD2.CTD_ITEM>>"
	cQuery += "		ELSE <<KEY_CTD_CTD1.CTD_FILIAL+CTD1.CTD_ITEM>>"
	cQuery += "	END AS BK_ITEM_CONTABIL9,"
	cQuery += "	CASE "
	cQuery += "		WHEN CTD8.CTD_ITEM IS NOT NULL THEN <<KEY_CTD_CTD8.CTD_FILIAL+CTD8.CTD_ITEM>>"
	cQuery += "		WHEN CTD7.CTD_ITEM IS NOT NULL THEN <<KEY_CTD_CTD7.CTD_FILIAL+CTD7.CTD_ITEM>>"
	cQuery += "		WHEN CTD6.CTD_ITEM IS NOT NULL THEN <<KEY_CTD_CTD6.CTD_FILIAL+CTD6.CTD_ITEM>>"
	cQuery += "		WHEN CTD5.CTD_ITEM IS NOT NULL THEN <<KEY_CTD_CTD5.CTD_FILIAL+CTD5.CTD_ITEM>>"
	cQuery += "		WHEN CTD4.CTD_ITEM IS NOT NULL THEN <<KEY_CTD_CTD4.CTD_FILIAL+CTD4.CTD_ITEM>>"
	cQuery += "		WHEN CTD3.CTD_ITEM IS NOT NULL THEN <<KEY_CTD_CTD3.CTD_FILIAL+CTD3.CTD_ITEM>>"
	cQuery += "		WHEN CTD2.CTD_ITEM IS NOT NULL THEN <<KEY_CTD_CTD2.CTD_FILIAL+CTD2.CTD_ITEM>>"
	cQuery += "		ELSE <<KEY_CTD_CTD1.CTD_FILIAL+CTD1.CTD_ITEM>>"
	cQuery += "	END AS BK_ITEM_CONTABIL8,"
	cQuery += "	CASE "
	cQuery += "		WHEN CTD7.CTD_ITEM IS NOT NULL THEN <<KEY_CTD_CTD7.CTD_FILIAL+CTD7.CTD_ITEM>>"
	cQuery += "		WHEN CTD6.CTD_ITEM IS NOT NULL THEN <<KEY_CTD_CTD6.CTD_FILIAL+CTD6.CTD_ITEM>>"
	cQuery += "		WHEN CTD5.CTD_ITEM IS NOT NULL THEN <<KEY_CTD_CTD5.CTD_FILIAL+CTD5.CTD_ITEM>>"
	cQuery += "		WHEN CTD4.CTD_ITEM IS NOT NULL THEN <<KEY_CTD_CTD4.CTD_FILIAL+CTD4.CTD_ITEM>>"
	cQuery += "		WHEN CTD3.CTD_ITEM IS NOT NULL THEN <<KEY_CTD_CTD3.CTD_FILIAL+CTD3.CTD_ITEM>>"
	cQuery += "		WHEN CTD2.CTD_ITEM IS NOT NULL THEN <<KEY_CTD_CTD2.CTD_FILIAL+CTD2.CTD_ITEM>>"
	cQuery += "		ELSE <<KEY_CTD_CTD1.CTD_FILIAL+CTD1.CTD_ITEM>>"
	cQuery += "	END AS BK_ITEM_CONTABIL7,"
	cQuery += "	CASE "
	cQuery += "		WHEN CTD6.CTD_ITEM IS NOT NULL THEN <<KEY_CTD_CTD6.CTD_FILIAL+CTD6.CTD_ITEM>>"
	cQuery += "		WHEN CTD5.CTD_ITEM IS NOT NULL THEN <<KEY_CTD_CTD5.CTD_FILIAL+CTD5.CTD_ITEM>>"
	cQuery += "		WHEN CTD4.CTD_ITEM IS NOT NULL THEN <<KEY_CTD_CTD4.CTD_FILIAL+CTD4.CTD_ITEM>>"
	cQuery += "		WHEN CTD3.CTD_ITEM IS NOT NULL THEN <<KEY_CTD_CTD3.CTD_FILIAL+CTD3.CTD_ITEM>>"
	cQuery += "		WHEN CTD2.CTD_ITEM IS NOT NULL THEN <<KEY_CTD_CTD2.CTD_FILIAL+CTD2.CTD_ITEM>>"
	cQuery += "		ELSE <<KEY_CTD_CTD1.CTD_FILIAL+CTD1.CTD_ITEM>>"
	cQuery += "	END AS BK_ITEM_CONTABIL6,"
	cQuery += "	CASE "
	cQuery += "		WHEN CTD5.CTD_ITEM IS NOT NULL THEN <<KEY_CTD_CTD5.CTD_FILIAL+CTD5.CTD_ITEM>>"
	cQuery += "		WHEN CTD4.CTD_ITEM IS NOT NULL THEN <<KEY_CTD_CTD4.CTD_FILIAL+CTD4.CTD_ITEM>>"
	cQuery += "		WHEN CTD3.CTD_ITEM IS NOT NULL THEN <<KEY_CTD_CTD3.CTD_FILIAL+CTD3.CTD_ITEM>>"
	cQuery += "		WHEN CTD2.CTD_ITEM IS NOT NULL THEN <<KEY_CTD_CTD2.CTD_FILIAL+CTD2.CTD_ITEM>>"
	cQuery += "		ELSE <<KEY_CTD_CTD1.CTD_FILIAL+CTD1.CTD_ITEM>>"
	cQuery += "	END AS BK_ITEM_CONTABIL5,"
	cQuery += "	CASE "
	cQuery += "		WHEN CTD4.CTD_ITEM IS NOT NULL THEN <<KEY_CTD_CTD4.CTD_FILIAL+CTD4.CTD_ITEM>>"
	cQuery += "		WHEN CTD3.CTD_ITEM IS NOT NULL THEN <<KEY_CTD_CTD3.CTD_FILIAL+CTD3.CTD_ITEM>>"
	cQuery += "		WHEN CTD2.CTD_ITEM IS NOT NULL THEN <<KEY_CTD_CTD2.CTD_FILIAL+CTD2.CTD_ITEM>>"
	cQuery += "		ELSE <<KEY_CTD_CTD1.CTD_FILIAL+CTD1.CTD_ITEM>>"
	cQuery += "	END AS BK_ITEM_CONTABIL4,"
	cQuery += "	CASE "
	cQuery += "		WHEN CTD3.CTD_ITEM IS NOT NULL THEN <<KEY_CTD_CTD3.CTD_FILIAL+CTD3.CTD_ITEM>>"
	cQuery += "		WHEN CTD2.CTD_ITEM IS NOT NULL THEN <<KEY_CTD_CTD2.CTD_FILIAL+CTD2.CTD_ITEM>>"
	cQuery += "		ELSE <<KEY_CTD_CTD1.CTD_FILIAL+CTD1.CTD_ITEM>>"
	cQuery += "	END AS BK_ITEM_CONTABIL3,"
	cQuery += "	CASE "
	cQuery += "		WHEN CTD2.CTD_ITEM IS NOT NULL THEN <<KEY_CTD_CTD2.CTD_FILIAL+CTD2.CTD_ITEM>>"
	cQuery += "		ELSE <<KEY_CTD_CTD1.CTD_FILIAL+CTD1.CTD_ITEM>>"
	cQuery += "	END AS BK_ITEM_CONTABIL2,"
	cQuery += "	<<KEY_CTD_CTD1.CTD_FILIAL+CTD1.CTD_ITEM>> AS BK_ITEM_CONTABIL1,"
	cQuery += " CASE "
	cQuery += "		WHEN CTD11.CTD_ITEM IS NOT NULL THEN CTD11.CTD_ITEM"
	cQuery += "		WHEN CTD10.CTD_ITEM IS NOT NULL THEN CTD10.CTD_ITEM"
	cQuery += "		WHEN CTD9.CTD_ITEM IS NOT NULL THEN CTD9.CTD_ITEM"
	cQuery += "		WHEN CTD8.CTD_ITEM IS NOT NULL THEN CTD8.CTD_ITEM"
	cQuery += "		WHEN CTD7.CTD_ITEM IS NOT NULL THEN CTD7.CTD_ITEM"
	cQuery += "		WHEN CTD6.CTD_ITEM IS NOT NULL THEN CTD6.CTD_ITEM"
	cQuery += "		WHEN CTD5.CTD_ITEM IS NOT NULL THEN CTD5.CTD_ITEM"
	cQuery += "		WHEN CTD4.CTD_ITEM IS NOT NULL THEN CTD4.CTD_ITEM"
	cQuery += "		WHEN CTD3.CTD_ITEM IS NOT NULL THEN CTD3.CTD_ITEM"
	cQuery += "		WHEN CTD2.CTD_ITEM IS NOT NULL THEN CTD2.CTD_ITEM"
	cQuery += "		ELSE CTD1.CTD_ITEM"
	cQuery += "	END AS CODIGO_ITEM11,"
	cQuery += "	CASE "
	cQuery += "		WHEN CTD10.CTD_ITEM IS NOT NULL THEN CTD10.CTD_ITEM"
	cQuery += "		WHEN CTD9.CTD_ITEM IS NOT NULL THEN CTD9.CTD_ITEM"
	cQuery += "		WHEN CTD8.CTD_ITEM IS NOT NULL THEN CTD8.CTD_ITEM"
	cQuery += "		WHEN CTD7.CTD_ITEM IS NOT NULL THEN CTD7.CTD_ITEM"
	cQuery += "		WHEN CTD6.CTD_ITEM IS NOT NULL THEN CTD6.CTD_ITEM"
	cQuery += "		WHEN CTD5.CTD_ITEM IS NOT NULL THEN CTD5.CTD_ITEM"
	cQuery += "		WHEN CTD4.CTD_ITEM IS NOT NULL THEN CTD4.CTD_ITEM"
	cQuery += "		WHEN CTD3.CTD_ITEM IS NOT NULL THEN CTD3.CTD_ITEM"
	cQuery += "		WHEN CTD2.CTD_ITEM IS NOT NULL THEN CTD2.CTD_ITEM"
	cQuery += "		ELSE CTD1.CTD_ITEM"
	cQuery += "	END AS CODIGO_ITEM10,"
	cQuery += "	CASE "
	cQuery += "		WHEN CTD9.CTD_ITEM IS NOT NULL THEN CTD9.CTD_ITEM"
	cQuery += "		WHEN CTD8.CTD_ITEM IS NOT NULL THEN CTD8.CTD_ITEM"
	cQuery += "		WHEN CTD7.CTD_ITEM IS NOT NULL THEN CTD7.CTD_ITEM"
	cQuery += "		WHEN CTD6.CTD_ITEM IS NOT NULL THEN CTD6.CTD_ITEM"
	cQuery += "		WHEN CTD5.CTD_ITEM IS NOT NULL THEN CTD5.CTD_ITEM"
	cQuery += "		WHEN CTD4.CTD_ITEM IS NOT NULL THEN CTD4.CTD_ITEM"
	cQuery += "		WHEN CTD3.CTD_ITEM IS NOT NULL THEN CTD3.CTD_ITEM"
	cQuery += "		WHEN CTD2.CTD_ITEM IS NOT NULL THEN CTD2.CTD_ITEM"
	cQuery += "		ELSE CTD1.CTD_ITEM"
	cQuery += "	END AS CODIGO_ITEM9,"
	cQuery += "	CASE "
	cQuery += "		WHEN CTD8.CTD_ITEM IS NOT NULL THEN CTD8.CTD_ITEM"
	cQuery += "		WHEN CTD7.CTD_ITEM IS NOT NULL THEN CTD7.CTD_ITEM"
	cQuery += "		WHEN CTD6.CTD_ITEM IS NOT NULL THEN CTD6.CTD_ITEM"
	cQuery += "		WHEN CTD5.CTD_ITEM IS NOT NULL THEN CTD5.CTD_ITEM"
	cQuery += "		WHEN CTD4.CTD_ITEM IS NOT NULL THEN CTD4.CTD_ITEM"
	cQuery += "		WHEN CTD3.CTD_ITEM IS NOT NULL THEN CTD3.CTD_ITEM"
	cQuery += "		WHEN CTD2.CTD_ITEM IS NOT NULL THEN CTD2.CTD_ITEM"
	cQuery += "		ELSE CTD1.CTD_ITEM"
	cQuery += "	END AS CODIGO_ITEM8,"
	cQuery += "	CASE "
	cQuery += "		WHEN CTD7.CTD_ITEM IS NOT NULL THEN CTD7.CTD_ITEM"
	cQuery += "		WHEN CTD6.CTD_ITEM IS NOT NULL THEN CTD6.CTD_ITEM"
	cQuery += "		WHEN CTD5.CTD_ITEM IS NOT NULL THEN CTD5.CTD_ITEM"
	cQuery += "		WHEN CTD4.CTD_ITEM IS NOT NULL THEN CTD4.CTD_ITEM"
	cQuery += "		WHEN CTD3.CTD_ITEM IS NOT NULL THEN CTD3.CTD_ITEM"
	cQuery += "		WHEN CTD2.CTD_ITEM IS NOT NULL THEN CTD2.CTD_ITEM"
	cQuery += "		ELSE CTD1.CTD_ITEM"
	cQuery += "	END AS CODIGO_ITEM7,"
	cQuery += "	CASE "
	cQuery += "		WHEN CTD6.CTD_ITEM IS NOT NULL THEN CTD6.CTD_ITEM"
	cQuery += "		WHEN CTD5.CTD_ITEM IS NOT NULL THEN CTD5.CTD_ITEM"
	cQuery += "		WHEN CTD4.CTD_ITEM IS NOT NULL THEN CTD4.CTD_ITEM"
	cQuery += "		WHEN CTD3.CTD_ITEM IS NOT NULL THEN CTD3.CTD_ITEM"
	cQuery += "		WHEN CTD2.CTD_ITEM IS NOT NULL THEN CTD2.CTD_ITEM"
	cQuery += "		ELSE CTD1.CTD_ITEM"
	cQuery += "	END AS CODIGO_ITEM6,"
	cQuery += "	CASE "
	cQuery += "		WHEN CTD5.CTD_ITEM IS NOT NULL THEN CTD5.CTD_ITEM"
	cQuery += "		WHEN CTD4.CTD_ITEM IS NOT NULL THEN CTD4.CTD_ITEM"
	cQuery += "		WHEN CTD3.CTD_ITEM IS NOT NULL THEN CTD3.CTD_ITEM"
	cQuery += "		WHEN CTD2.CTD_ITEM IS NOT NULL THEN CTD2.CTD_ITEM"
	cQuery += "		ELSE CTD1.CTD_ITEM"
	cQuery += "	END AS CODIGO_ITEM5,"
	cQuery += "	CASE "
	cQuery += "		WHEN CTD4.CTD_ITEM IS NOT NULL THEN CTD4.CTD_ITEM"
	cQuery += "		WHEN CTD3.CTD_ITEM IS NOT NULL THEN CTD3.CTD_ITEM"
	cQuery += "		WHEN CTD2.CTD_ITEM IS NOT NULL THEN CTD2.CTD_ITEM"
	cQuery += "		ELSE CTD1.CTD_ITEM"
	cQuery += "	END AS CODIGO_ITEM4,"
	cQuery += "	CASE "
	cQuery += "		WHEN CTD3.CTD_ITEM IS NOT NULL THEN CTD3.CTD_ITEM"
	cQuery += "		WHEN CTD2.CTD_ITEM IS NOT NULL THEN CTD2.CTD_ITEM"
	cQuery += "		ELSE CTD1.CTD_ITEM"
	cQuery += "	END AS CODIGO_ITEM3,"
	cQuery += "	CASE "
	cQuery += "		WHEN CTD2.CTD_ITEM IS NOT NULL THEN CTD2.CTD_ITEM"
	cQuery += "		ELSE CTD1.CTD_ITEM"
	cQuery += "	END AS CODIGO_ITEM2,"
	cQuery += "	CTD1.CTD_ITEM AS CODIGO_ITEM1,"
	cQuery += " CASE " 
	cQuery += "		WHEN CTD11.CTD_ITEM IS NOT NULL THEN CTD11.CTD_DESC01"
	cQuery += "		WHEN CTD10.CTD_ITEM IS NOT NULL THEN CTD10.CTD_DESC01"
	cQuery += "		WHEN CTD9.CTD_ITEM IS NOT NULL THEN CTD9.CTD_DESC01"
	cQuery += "		WHEN CTD8.CTD_ITEM IS NOT NULL THEN CTD8.CTD_DESC01"
	cQuery += "		WHEN CTD7.CTD_ITEM IS NOT NULL THEN CTD7.CTD_DESC01"
	cQuery += "		WHEN CTD6.CTD_ITEM IS NOT NULL THEN CTD6.CTD_DESC01"
	cQuery += "		WHEN CTD5.CTD_ITEM IS NOT NULL THEN CTD5.CTD_DESC01"
	cQuery += "		WHEN CTD4.CTD_ITEM IS NOT NULL THEN CTD4.CTD_DESC01"
	cQuery += "		WHEN CTD3.CTD_ITEM IS NOT NULL THEN CTD3.CTD_DESC01"
	cQuery += "		WHEN CTD2.CTD_ITEM IS NOT NULL THEN CTD2.CTD_DESC01"
	cQuery += "		ELSE CTD1.CTD_DESC01"
	cQuery += "	END AS DESC_ITEM11,"
	cQuery += "	CASE "
	cQuery += "		WHEN CTD10.CTD_ITEM IS NOT NULL THEN CTD10.CTD_DESC01"
	cQuery += "		WHEN CTD9.CTD_ITEM IS NOT NULL THEN CTD9.CTD_DESC01"
	cQuery += "		WHEN CTD8.CTD_ITEM IS NOT NULL THEN CTD8.CTD_DESC01"
	cQuery += "		WHEN CTD7.CTD_ITEM IS NOT NULL THEN CTD7.CTD_DESC01"
	cQuery += "		WHEN CTD6.CTD_ITEM IS NOT NULL THEN CTD6.CTD_DESC01"
	cQuery += "		WHEN CTD5.CTD_ITEM IS NOT NULL THEN CTD5.CTD_DESC01"
	cQuery += "		WHEN CTD4.CTD_ITEM IS NOT NULL THEN CTD4.CTD_DESC01"
	cQuery += "		WHEN CTD3.CTD_ITEM IS NOT NULL THEN CTD3.CTD_DESC01"
	cQuery += "		WHEN CTD2.CTD_ITEM IS NOT NULL THEN CTD2.CTD_DESC01"
	cQuery += "		ELSE CTD1.CTD_DESC01"
	cQuery += "	END AS DESC_ITEM10,"
	cQuery += "	CASE "
	cQuery += "		WHEN CTD9.CTD_ITEM IS NOT NULL THEN CTD9.CTD_DESC01"
	cQuery += "		WHEN CTD8.CTD_ITEM IS NOT NULL THEN CTD8.CTD_DESC01"
	cQuery += "		WHEN CTD7.CTD_ITEM IS NOT NULL THEN CTD7.CTD_DESC01"
	cQuery += "		WHEN CTD6.CTD_ITEM IS NOT NULL THEN CTD6.CTD_DESC01"
	cQuery += "		WHEN CTD5.CTD_ITEM IS NOT NULL THEN CTD5.CTD_DESC01"
	cQuery += "		WHEN CTD4.CTD_ITEM IS NOT NULL THEN CTD4.CTD_DESC01"
	cQuery += "		WHEN CTD3.CTD_ITEM IS NOT NULL THEN CTD3.CTD_DESC01"
	cQuery += "		WHEN CTD2.CTD_ITEM IS NOT NULL THEN CTD2.CTD_DESC01"
	cQuery += "		ELSE CTD1.CTD_DESC01"
	cQuery += "	END AS DESC_ITEM9,"
	cQuery += "	CASE "
	cQuery += "		WHEN CTD8.CTD_ITEM IS NOT NULL THEN CTD8.CTD_DESC01"
	cQuery += "		WHEN CTD7.CTD_ITEM IS NOT NULL THEN CTD7.CTD_DESC01"
	cQuery += "		WHEN CTD6.CTD_ITEM IS NOT NULL THEN CTD6.CTD_DESC01"
	cQuery += "		WHEN CTD5.CTD_ITEM IS NOT NULL THEN CTD5.CTD_DESC01"
	cQuery += "		WHEN CTD4.CTD_ITEM IS NOT NULL THEN CTD4.CTD_DESC01"
	cQuery += "		WHEN CTD3.CTD_ITEM IS NOT NULL THEN CTD3.CTD_DESC01"
	cQuery += "		WHEN CTD2.CTD_ITEM IS NOT NULL THEN CTD2.CTD_DESC01"
	cQuery += "		ELSE CTD1.CTD_DESC01"
	cQuery += "		END AS DESC_ITEM8,"
	cQuery += "	CASE "
	cQuery += "		WHEN CTD7.CTD_ITEM IS NOT NULL THEN CTD7.CTD_DESC01"
	cQuery += "		WHEN CTD6.CTD_ITEM IS NOT NULL THEN CTD6.CTD_DESC01"
	cQuery += "		WHEN CTD5.CTD_ITEM IS NOT NULL THEN CTD5.CTD_DESC01"
	cQuery += "		WHEN CTD4.CTD_ITEM IS NOT NULL THEN CTD4.CTD_DESC01"
	cQuery += "		WHEN CTD3.CTD_ITEM IS NOT NULL THEN CTD3.CTD_DESC01"
	cQuery += "		WHEN CTD2.CTD_ITEM IS NOT NULL THEN CTD2.CTD_DESC01"
	cQuery += "		ELSE CTD1.CTD_DESC01"
	cQuery += "	END AS DESC_ITEM7,"
	cQuery += "	CASE "
	cQuery += "		WHEN CTD6.CTD_ITEM IS NOT NULL THEN CTD6.CTD_DESC01"
	cQuery += "		WHEN CTD5.CTD_ITEM IS NOT NULL THEN CTD5.CTD_DESC01"
	cQuery += "		WHEN CTD4.CTD_ITEM IS NOT NULL THEN CTD4.CTD_DESC01"
	cQuery += "		WHEN CTD3.CTD_ITEM IS NOT NULL THEN CTD3.CTD_DESC01"
	cQuery += "		WHEN CTD2.CTD_ITEM IS NOT NULL THEN CTD2.CTD_DESC01"
	cQuery += "		ELSE CTD1.CTD_DESC01"
	cQuery += "	END AS DESC_ITEM6,"
	cQuery += "	CASE "
	cQuery += "		WHEN CTD5.CTD_ITEM IS NOT NULL THEN CTD5.CTD_DESC01"
	cQuery += "		WHEN CTD4.CTD_ITEM IS NOT NULL THEN CTD4.CTD_DESC01"
	cQuery += "		WHEN CTD3.CTD_ITEM IS NOT NULL THEN CTD3.CTD_DESC01"
	cQuery += "		WHEN CTD2.CTD_ITEM IS NOT NULL THEN CTD2.CTD_DESC01"
	cQuery += "		ELSE CTD1.CTD_DESC01"
	cQuery += "	END AS DESC_ITEM5,"
	cQuery += "	CASE "
	cQuery += "		WHEN CTD4.CTD_ITEM IS NOT NULL THEN CTD4.CTD_DESC01"
	cQuery += "		WHEN CTD3.CTD_ITEM IS NOT NULL THEN CTD3.CTD_DESC01"
	cQuery += "		WHEN CTD2.CTD_ITEM IS NOT NULL THEN CTD2.CTD_DESC01"
	cQuery += "		ELSE CTD1.CTD_DESC01"
	cQuery += "	END AS DESC_ITEM4,"
	cQuery += "	CASE "
	cQuery += "		WHEN CTD3.CTD_ITEM IS NOT NULL THEN CTD3.CTD_DESC01"
	cQuery += "		WHEN CTD2.CTD_ITEM IS NOT NULL THEN CTD2.CTD_DESC01"
	cQuery += "		ELSE CTD1.CTD_DESC01"
	cQuery += "	END AS DESC_ITEM3,"
	cQuery += "	CASE "
	cQuery += "		WHEN CTD2.CTD_ITEM IS NOT NULL THEN CTD2.CTD_DESC01"
	cQuery += "		ELSE CTD1.CTD_DESC01"
	cQuery += "	END AS DESC_ITEM2,"
	cQuery += "	CTD1.CTD_DESC01 AS DESC_ITEM1,"
	cQuery += " <<CODE_INSTANCE>> AS INSTANCIA "
	cQuery += " FROM <<CTD_COMPANY>> CTD1"
	cQuery += " LEFT JOIN <<CTD_COMPANY>> CTD2" 
	cQuery += "   ON CTD2.CTD_ITSUP = CTD1.CTD_ITEM"
	cQuery += "  AND CTD2.CTD_FILIAL = CTD1.CTD_FILIAL" 
	cQuery += "  AND CTD2.CTD_ITEM <> CTD2.CTD_ITSUP"
	cQuery += "  AND CTD2.CTD_ITSUP <> ' ' "
	cQuery += " LEFT JOIN <<CTD_COMPANY>> CTD3 "
	cQuery += "   ON CTD3.CTD_ITSUP = CTD2.CTD_ITEM"
	cQuery += "  AND CTD3.CTD_FILIAL = CTD2.CTD_FILIAL"   
	cQuery += "  AND CTD3.CTD_ITEM <> CTD3.CTD_ITSUP"
	cQuery += " LEFT JOIN <<CTD_COMPANY>> CTD4" 
	cQuery += "   ON CTD4.CTD_ITSUP = CTD3.CTD_ITEM"
	cQuery += "  AND CTD4.CTD_FILIAL = CTD3.CTD_FILIAL"   
	cQuery += "  AND CTD4.CTD_ITEM <> CTD4.CTD_ITSUP"
	cQuery += " LEFT JOIN <<CTD_COMPANY>> CTD5"  
	cQuery += "   ON CTD5.CTD_ITSUP = CTD4.CTD_ITEM"
	cQuery += "  AND CTD5.CTD_FILIAL = CTD4.CTD_FILIAL"   
	cQuery += "  AND CTD5.CTD_ITEM <> CTD5.CTD_ITSUP"
	cQuery += " LEFT JOIN <<CTD_COMPANY>> CTD6" 
	cQuery += "   ON CTD6.CTD_ITSUP = CTD5.CTD_ITEM"
	cQuery += "  AND CTD6.CTD_FILIAL = CTD5.CTD_FILIAL"   
	cQuery += "  AND CTD6.CTD_ITEM <> CTD6.CTD_ITSUP"
	cQuery += " LEFT JOIN <<CTD_COMPANY>> CTD7" 
	cQuery += "   ON CTD7.CTD_ITSUP = CTD6.CTD_ITEM"
	cQuery += "  AND CTD7.CTD_FILIAL = CTD6.CTD_FILIAL"   
	cQuery += "  AND CTD7.CTD_ITEM <> CTD7.CTD_ITSUP"
	cQuery += " LEFT JOIN <<CTD_COMPANY>> CTD8" 
	cQuery += "   ON CTD8.CTD_ITSUP = CTD7.CTD_ITEM"
	cQuery += "  AND CTD8.CTD_FILIAL = CTD7.CTD_FILIAL"   
	cQuery += "  AND CTD8.CTD_ITEM <> CTD8.CTD_ITSUP"
	cQuery += " LEFT JOIN <<CTD_COMPANY>> CTD9" 
	cQuery += "   ON CTD9.CTD_ITSUP = CTD8.CTD_ITEM"
	cQuery += "  AND CTD9.CTD_FILIAL = CTD8.CTD_FILIAL"   
	cQuery += "  AND CTD9.CTD_ITEM <> CTD9.CTD_ITSUP"
	cQuery += " LEFT JOIN <<CTD_COMPANY>> CTD10" 
	cQuery += "   ON CTD10.CTD_ITSUP = CTD9.CTD_ITEM"
	cQuery += "  AND CTD10.CTD_FILIAL = CTD9.CTD_FILIAL"   
	cQuery += "  AND CTD10.CTD_ITEM <> CTD10.CTD_ITSUP"
	cQuery += " LEFT JOIN <<CTD_COMPANY>> CTD11" 
	cQuery += "   ON CTD11.CTD_ITSUP = CTD10.CTD_ITEM"
	cQuery += "  AND CTD11.CTD_FILIAL = CTD10.CTD_FILIAL"   
	cQuery += "  AND CTD11.CTD_ITEM <> CTD11.CTD_ITSUP"
	cQuery += " WHERE CTD1.D_E_L_E_T_ = ' ' "
	cQuery += "  <<AND_XFILIAL_CTD1.CTD_FILIAL>> "
	cQuery += "  AND ( CTD1.CTD_ITEM = CTD1.CTD_ITSUP OR CTD1.CTD_ITSUP = ' ' )"

Return cQuery
