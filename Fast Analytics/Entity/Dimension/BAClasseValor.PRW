#INCLUDE "BADEFINITION.CH"

NEW ENTITY CLASSEVALOR

//-------------------------------------------------------------------
/*/{Protheus.doc} BAClasseValor
Visualiza as informacoes de Classe Valor.

@author  Helio Leal
@author  Angelo Lee
@since   09/03/2018
/*/
//-------------------------------------------------------------------
Class BAClasseValor from BAEntity
	Method Setup( ) CONSTRUCTOR
	Method BuildQuery( )
EndClass

//-------------------------------------------------------------------
/*/{Protheus.doc} New
Construtor padrao.

@author  Helio Leal
@author  Angelo Lee
@since   09/03/2018
/*/
//-------------------------------------------------------------------
Method Setup( ) Class BAClasseValor
	_Super:Setup("ClasseValor", DIMENSION, "CTH")
Return

//-------------------------------------------------------------------
/*/{Protheus.doc} BuildQuery
Constroi a query da entidade.
@return cQuery, string, query a ser processada.

@author  Helio Leal
@author  Angelo Lee
@since   09/03/2018
/*/
//-------------------------------------------------------------------
Method BuildQuery( ) Class BAClasseValor
	Local cQuery := ""

	cQuery += " SELECT " + ;
				"CASE " + ;
					"WHEN CTH11.CTH_CLVL IS NOT NULL " + ;
						"THEN <<KEY_CTH_CTH11.CTH_FILIAL+CTH11.CTH_CLVL>> " + ;
					"WHEN CTH10.CTH_CLVL IS NOT NULL " + ;
						"THEN <<KEY_CTH_CTH10.CTH_FILIAL+CTH10.CTH_CLVL>> " + ;
					"WHEN CTH9.CTH_CLVL IS NOT NULL " + ;
						"THEN <<KEY_CTH_CTH9.CTH_FILIAL+CTH9.CTH_CLVL>> " + ;
					"WHEN CTH8.CTH_CLVL IS NOT NULL " + ;
						"THEN <<KEY_CTH_CTH8.CTH_FILIAL+CTH8.CTH_CLVL>> " + ;
					"WHEN CTH7.CTH_CLVL IS NOT NULL " + ;
						"THEN <<KEY_CTH_CTH7.CTH_FILIAL+CTH7.CTH_CLVL>> " + ;
					"WHEN CTH6.CTH_CLVL IS NOT NULL " + ;
						"THEN <<KEY_CTH_CTH6.CTH_FILIAL+CTH6.CTH_CLVL>> " + ;
					"WHEN CTH5.CTH_CLVL IS NOT NULL " + ;
						"THEN <<KEY_CTH_CTH5.CTH_FILIAL+CTH5.CTH_CLVL>> " + ;
					"WHEN CTH4.CTH_CLVL IS NOT NULL " + ;
						"THEN <<KEY_CTH_CTH4.CTH_FILIAL+CTH4.CTH_CLVL>> " + ;
					"WHEN CTH3.CTH_CLVL IS NOT NULL " + ;
						"THEN <<KEY_CTH_CTH3.CTH_FILIAL+CTH3.CTH_CLVL>> " + ;
					"WHEN CTH2.CTH_CLVL IS NOT NULL " + ;
						"THEN <<KEY_CTH_CTH2.CTH_FILIAL+CTH2.CTH_CLVL>> " + ;
					"ELSE <<KEY_CTH_CTH1.CTH_FILIAL+CTH1.CTH_CLVL>> " + ;
				"END AS BK_CLASSE_VALOR11, " + ;
	 			"CASE " + ;
					"WHEN CTH10.CTH_CLVL IS NOT NULL " + ;
						"THEN <<KEY_CTH_CTH10.CTH_FILIAL+CTH10.CTH_CLVL>> " + ;
		    		"WHEN CTH9.CTH_CLVL IS NOT NULL " + ;
		      			"THEN <<KEY_CTH_CTH9.CTH_FILIAL+CTH9.CTH_CLVL>> " + ;
		      		"WHEN CTH8.CTH_CLVL IS NOT NULL " + ;
		      			"THEN <<KEY_CTH_CTH8.CTH_FILIAL+CTH8.CTH_CLVL>> " + ;
		      		"WHEN CTH7.CTH_CLVL IS NOT NULL " + ;
		      			"THEN <<KEY_CTH_CTH7.CTH_FILIAL+CTH7.CTH_CLVL>> " + ;
		      		"WHEN CTH6.CTH_CLVL IS NOT NULL " + ;
		      			"THEN <<KEY_CTH_CTH6.CTH_FILIAL+CTH6.CTH_CLVL>> " + ;
		      		"WHEN CTH5.CTH_CLVL IS NOT NULL " + ;
		    			"THEN <<KEY_CTH_CTH5.CTH_FILIAL+CTH5.CTH_CLVL>> " + ;
		      		"WHEN CTH4.CTH_CLVL IS NOT NULL " + ;
		    			"THEN <<KEY_CTH_CTH4.CTH_FILIAL+CTH4.CTH_CLVL>> " + ;
		      		"WHEN CTH3.CTH_CLVL IS NOT NULL " + ;
		    			"THEN <<KEY_CTH_CTH3.CTH_FILIAL+CTH3.CTH_CLVL>> " + ;
		      		"WHEN CTH2.CTH_CLVL IS NOT NULL " + ;
		    			"THEN <<KEY_CTH_CTH2.CTH_FILIAL+CTH2.CTH_CLVL>> " + ;
		      		"ELSE <<KEY_CTH_CTH1.CTH_FILIAL+CTH1.CTH_CLVL>> " + ;
		      	"END AS BK_CLASSE_VALOR10, " + ;
	 			"CASE " + ;
		      		"WHEN CTH9.CTH_CLVL IS NOT NULL " + ;
		    			"THEN <<KEY_CTH_CTH9.CTH_FILIAL+CTH9.CTH_CLVL>> " + ;
		      		"WHEN CTH8.CTH_CLVL IS NOT NULL " + ;
		    			"THEN <<KEY_CTH_CTH8.CTH_FILIAL+CTH8.CTH_CLVL>> " + ;
		      		"WHEN CTH7.CTH_CLVL IS NOT NULL " + ;
		    			"THEN <<KEY_CTH_CTH7.CTH_FILIAL+CTH7.CTH_CLVL>> " + ;
		      		"WHEN CTH6.CTH_CLVL IS NOT NULL " + ;
		    			"THEN <<KEY_CTH_CTH6.CTH_FILIAL+CTH6.CTH_CLVL>> " + ;
		      		"WHEN CTH5.CTH_CLVL IS NOT NULL " + ;
		    			"THEN <<KEY_CTH_CTH5.CTH_FILIAL+CTH5.CTH_CLVL>> " + ;
		      		"WHEN CTH4.CTH_CLVL IS NOT NULL " + ;
		    			"THEN <<KEY_CTH_CTH4.CTH_FILIAL+CTH4.CTH_CLVL>> " + ;
		      		"WHEN CTH3.CTH_CLVL IS NOT NULL " + ;
		    			"THEN <<KEY_CTH_CTH3.CTH_FILIAL+CTH3.CTH_CLVL>> " + ;
		      		"WHEN CTH2.CTH_CLVL IS NOT NULL " + ;
		    			"THEN <<KEY_CTH_CTH2.CTH_FILIAL+CTH2.CTH_CLVL>> " + ;
		      		"ELSE <<KEY_CTH_CTH1.CTH_FILIAL+CTH1.CTH_CLVL>> " + ;
		      	"END AS BK_CLASSE_VALOR9, " + ;
				"CASE " + ;
		      		"WHEN CTH8.CTH_CLVL IS NOT NULL " + ;
		    			"THEN <<KEY_CTH_CTH8.CTH_FILIAL+CTH8.CTH_CLVL>> " + ;
		      		"WHEN CTH7.CTH_CLVL IS NOT NULL " + ;
		    			"THEN <<KEY_CTH_CTH7.CTH_FILIAL+CTH7.CTH_CLVL>> " + ;
		      		"WHEN CTH6.CTH_CLVL IS NOT NULL " + ;
		    			"THEN <<KEY_CTH_CTH6.CTH_FILIAL+CTH6.CTH_CLVL>> " + ;
		      		"WHEN CTH5.CTH_CLVL IS NOT NULL " + ;
		    			"THEN <<KEY_CTH_CTH5.CTH_FILIAL+CTH5.CTH_CLVL>> " + ;
		      		"WHEN CTH4.CTH_CLVL IS NOT NULL " + ;
		    			"THEN <<KEY_CTH_CTH4.CTH_FILIAL+CTH4.CTH_CLVL>> " + ;
		      		"WHEN CTH3.CTH_CLVL IS NOT NULL " + ;
		    			"THEN <<KEY_CTH_CTH3.CTH_FILIAL+CTH3.CTH_CLVL>> " + ;
		      		"WHEN CTH2.CTH_CLVL IS NOT NULL " + ;
		    			"THEN <<KEY_CTH_CTH2.CTH_FILIAL+CTH2.CTH_CLVL>> " + ;
		      		"ELSE <<KEY_CTH_CTH1.CTH_FILIAL+CTH1.CTH_CLVL>> " + ;
		      	"END AS BK_CLASSE_VALOR8, " + ;
  				"CASE " + ;   
		      		"WHEN CTH7.CTH_CLVL IS NOT NULL " + ;  
		    			"THEN <<KEY_CTH_CTH7.CTH_FILIAL+CTH7.CTH_CLVL>> " + ;     
		      		"WHEN CTH6.CTH_CLVL IS NOT NULL " + ;      
		    			"THEN <<KEY_CTH_CTH6.CTH_FILIAL+CTH6.CTH_CLVL>> " + ; 
		      		"WHEN CTH5.CTH_CLVL IS NOT NULL " + ; 
		    			"THEN <<KEY_CTH_CTH5.CTH_FILIAL+CTH5.CTH_CLVL>> " + ;     
		      		"WHEN CTH4.CTH_CLVL IS NOT NULL " + ; 
		    			"THEN <<KEY_CTH_CTH4.CTH_FILIAL+CTH4.CTH_CLVL>> " + ;  
		      		"WHEN CTH3.CTH_CLVL IS NOT NULL " + ;      
		    			"THEN <<KEY_CTH_CTH3.CTH_FILIAL+CTH3.CTH_CLVL>> " + ;  
		      		"WHEN CTH2.CTH_CLVL IS NOT NULL " + ;  
		    			"THEN <<KEY_CTH_CTH2.CTH_FILIAL+CTH2.CTH_CLVL>> " + ; 
		      		"ELSE <<KEY_CTH_CTH1.CTH_FILIAL+CTH1.CTH_CLVL>> " + ;    
		      	"END AS BK_CLASSE_VALOR7, " + ;
  				"CASE " + ;   
		      		"WHEN CTH6.CTH_CLVL IS NOT NULL " + ; 
		    			"THEN <<KEY_CTH_CTH6.CTH_FILIAL+CTH6.CTH_CLVL>> " + ; 
		      		"WHEN CTH5.CTH_CLVL IS NOT NULL " + ;    
		    			"THEN <<KEY_CTH_CTH5.CTH_FILIAL+CTH5.CTH_CLVL>> " + ;     
		      		"WHEN CTH4.CTH_CLVL IS NOT NULL " + ;    
		    			"THEN <<KEY_CTH_CTH4.CTH_FILIAL+CTH4.CTH_CLVL>> " + ; 
		      		"WHEN CTH3.CTH_CLVL IS NOT NULL " + ; 
		    			"THEN <<KEY_CTH_CTH3.CTH_FILIAL+CTH3.CTH_CLVL>> " + ; 
		      		"WHEN CTH2.CTH_CLVL IS NOT NULL " + ;   
		    			"THEN <<KEY_CTH_CTH2.CTH_FILIAL+CTH2.CTH_CLVL>> " + ; 
		      		"ELSE <<KEY_CTH_CTH1.CTH_FILIAL+CTH1.CTH_CLVL>> " + ;     
		      	"END AS BK_CLASSE_VALOR6, " + ;
				"CASE " + ;    
					"WHEN CTH5.CTH_CLVL IS NOT NULL " + ;   
						"THEN <<KEY_CTH_CTH5.CTH_FILIAL+CTH5.CTH_CLVL>> " + ;   
					"WHEN CTH4.CTH_CLVL IS NOT NULL " + ;   
						"THEN <<KEY_CTH_CTH4.CTH_FILIAL+CTH4.CTH_CLVL>> " + ; 
					"WHEN CTH3.CTH_CLVL IS NOT NULL " + ;  
						"THEN <<KEY_CTH_CTH3.CTH_FILIAL+CTH3.CTH_CLVL>> " + ;  
					"WHEN CTH2.CTH_CLVL IS NOT NULL " + ;   
						"THEN <<KEY_CTH_CTH2.CTH_FILIAL+CTH2.CTH_CLVL>> " + ; 
					"ELSE <<KEY_CTH_CTH1.CTH_FILIAL+CTH1.CTH_CLVL>> " + ;  
				"END AS BK_CLASSE_VALOR5, " + ;
				"CASE " + ;   
					"WHEN CTH4.CTH_CLVL IS NOT NULL " + ;   
						"THEN <<KEY_CTH_CTH4.CTH_FILIAL+CTH4.CTH_CLVL>> " + ;   
					"WHEN CTH3.CTH_CLVL IS NOT NULL " + ;  
						"THEN <<KEY_CTH_CTH3.CTH_FILIAL+CTH3.CTH_CLVL>> " + ;  
					"WHEN CTH2.CTH_CLVL IS NOT NULL " + ;   
						"THEN <<KEY_CTH_CTH2.CTH_FILIAL+CTH2.CTH_CLVL>> " + ; 
					"ELSE <<KEY_CTH_CTH1.CTH_FILIAL+CTH1.CTH_CLVL>> " + ;   
				"END AS BK_CLASSE_VALOR4, " + ;   
				"CASE " + ;    
					"WHEN CTH3.CTH_CLVL IS NOT NULL " + ; 
						"THEN <<KEY_CTH_CTH3.CTH_FILIAL+CTH2.CTH_CLVL>> " + ;      
					"WHEN CTH2.CTH_CLVL IS NOT NULL " + ; 
						"THEN <<KEY_CTH_CTH2.CTH_FILIAL+CTH2.CTH_CLVL>> " + ; 
					"ELSE <<KEY_CTH_CTH1.CTH_FILIAL+CTH1.CTH_CLVL>> " + ;  
				"END AS BK_CLASSE_VALOR3, " + ;  
				"CASE " + ;  
					"WHEN CTH2.CTH_CLVL IS NOT NULL " + ; 
						"THEN <<KEY_CTH_CTH2.CTH_FILIAL+CTH2.CTH_CLVL>> " + ; 
					"ELSE <<KEY_CTH_CTH1.CTH_FILIAL+CTH1.CTH_CLVL>> " + ;   
				"END AS BK_CLASSE_VALOR2, " + ;
				"<<KEY_CTH_CTH1.CTH_FILIAL+CTH1.CTH_CLVL>> AS BK_CLASSE_VALOR1, " + ;  
				"CASE " + ;     
					"WHEN CTH11.CTH_CLVL IS NOT NULL " + ;   
						"THEN CTH11.CTH_DESC01 " + ;  
					"WHEN CTH10.CTH_CLVL IS NOT NULL " + ; 
						"THEN CTH10.CTH_DESC01 " + ; 
					"WHEN CTH9.CTH_CLVL IS NOT NULL " + ; 
						"THEN CTH9.CTH_DESC01 " + ; 
					"WHEN CTH8.CTH_CLVL IS NOT NULL " + ;  
						"THEN CTH8.CTH_DESC01 " + ;   
					"WHEN CTH7.CTH_CLVL IS NOT NULL " + ;   
						"THEN CTH7.CTH_DESC01 " + ;  
					"WHEN CTH6.CTH_CLVL IS NOT NULL " + ; 
						"THEN CTH6.CTH_DESC01 " + ;  
					"WHEN CTH5.CTH_CLVL IS NOT NULL " + ;   
						"THEN CTH5.CTH_DESC01 " + ;     
					"WHEN CTH4.CTH_CLVL IS NOT NULL " + ; 
						"THEN CTH4.CTH_DESC01 " + ;   
					"WHEN CTH3.CTH_CLVL IS NOT NULL " + ; 
						"THEN CTH3.CTH_DESC01 " + ;   
					"WHEN CTH2.CTH_CLVL IS NOT NULL " + ;     
						"THEN CTH2.CTH_DESC01 " + ; 
					"ELSE CTH1.CTH_DESC01 " + ; 
				"END AS DESC_MOEDA11, " + ;
				"CASE " + ;     
					"WHEN CTH10.CTH_CLVL IS NOT NULL " + ;   
						"THEN CTH10.CTH_DESC01 " + ; 
					"WHEN CTH9.CTH_CLVL IS NOT NULL " + ;
						"THEN CTH9.CTH_DESC01 " + ; 
					"WHEN CTH8.CTH_CLVL IS NOT NULL " + ;      
						"THEN CTH8.CTH_DESC01 " + ;  
					"WHEN CTH7.CTH_CLVL IS NOT NULL " + ;      
						"THEN CTH7.CTH_DESC01 " + ; 
					"WHEN CTH6.CTH_CLVL IS NOT NULL " + ;      
						"THEN CTH6.CTH_DESC01 " + ; 
					"WHEN CTH5.CTH_CLVL IS NOT NULL " + ;      
						"THEN CTH5.CTH_DESC01 " + ; 
					"WHEN CTH4.CTH_CLVL IS NOT NULL " + ;      
						"THEN CTH4.CTH_DESC01 " + ; 
					"WHEN CTH3.CTH_CLVL IS NOT NULL " + ;      
						"THEN CTH3.CTH_DESC01 " + ; 
					"WHEN CTH2.CTH_CLVL IS NOT NULL " + ;      
						"THEN CTH2.CTH_DESC01 " + ; 
					"ELSE CTH1.CTH_DESC01 " + ;  
				"END AS DESC_MOEDA10, " + ;     
				"CASE " + ;  
					"WHEN CTH9.CTH_CLVL IS NOT NULL " + ;      
						"THEN CTH9.CTH_DESC01 " + ; 
					"WHEN CTH8.CTH_CLVL IS NOT NULL " + ;      
						"THEN CTH8.CTH_DESC01 " + ; 
					"WHEN CTH7.CTH_CLVL IS NOT NULL " + ;      
						"THEN CTH7.CTH_DESC01 " + ; 
					"WHEN CTH6.CTH_CLVL IS NOT NULL " + ;  
						"THEN CTH6.CTH_DESC01 " + ; 
					"WHEN CTH5.CTH_CLVL IS NOT NULL " + ;      
						"THEN CTH5.CTH_DESC01 " + ; 
					"WHEN CTH4.CTH_CLVL IS NOT NULL " + ;     
						"THEN CTH4.CTH_DESC01 " + ; 
					"WHEN CTH3.CTH_CLVL IS NOT NULL " + ;      
						"THEN CTH3.CTH_DESC01 " + ; 
					"WHEN CTH2.CTH_CLVL IS NOT NULL " + ;      
						"THEN CTH2.CTH_DESC01 " + ; 
					"ELSE CTH1.CTH_DESC01 " + ;  
				"END AS DESC_MOEDA9, " + ;  
				"CASE " + ;  
					"WHEN CTH8.CTH_CLVL IS NOT NULL " + ;      
						"THEN CTH8.CTH_DESC01 " + ;  
					"WHEN CTH7.CTH_CLVL IS NOT NULL " + ;      
						"THEN CTH7.CTH_DESC01 " + ; 
					"WHEN CTH6.CTH_CLVL IS NOT NULL " + ;      
						"THEN CTH6.CTH_DESC01 " + ; 
					"WHEN CTH5.CTH_CLVL IS NOT NULL " + ;      
						"THEN CTH5.CTH_DESC01 " + ;  
					"WHEN CTH4.CTH_CLVL IS NOT NULL " + ;      
						"THEN CTH4.CTH_DESC01 " + ; 
					"WHEN CTH3.CTH_CLVL IS NOT NULL " + ;      
						"THEN CTH3.CTH_DESC01 " + ;  
					"WHEN CTH2.CTH_CLVL IS NOT NULL " + ;      
						"THEN CTH2.CTH_DESC01 " + ; 
					"ELSE CTH1.CTH_DESC01 " + ;  
				"END AS DESC_MOEDA8, " + ;      
				"CASE " + ;  
					"WHEN CTH7.CTH_CLVL IS NOT NULL " + ;      
						"THEN CTH7.CTH_DESC01 " + ; 
					"WHEN CTH6.CTH_CLVL IS NOT NULL " + ;      
						"THEN CTH6.CTH_DESC01 " + ; 
					"WHEN CTH5.CTH_CLVL IS NOT NULL " + ;      
						"THEN CTH5.CTH_DESC01 " + ; 
					"WHEN CTH4.CTH_CLVL IS NOT NULL " + ;      
						"THEN CTH4.CTH_DESC01 " + ; 
					"WHEN CTH3.CTH_CLVL IS NOT NULL " + ;      
						"THEN CTH3.CTH_DESC01 " + ; 
					"WHEN CTH2.CTH_CLVL IS NOT NULL " + ;      
						"THEN CTH2.CTH_DESC01 " + ; 
					"ELSE CTH1.CTH_DESC01 " + ;  
				"END AS DESC_MOEDA7, " + ;     
				"CASE " + ;  
					"WHEN CTH6.CTH_CLVL IS NOT NULL " + ;      
						"THEN CTH6.CTH_DESC01 " + ; 
					"WHEN CTH5.CTH_CLVL IS NOT NULL " + ;     
						"THEN CTH5.CTH_DESC01 " + ; 
					"WHEN CTH4.CTH_CLVL IS NOT NULL " + ;      
						"THEN CTH4.CTH_DESC01 " + ; 
					"WHEN CTH3.CTH_CLVL IS NOT NULL " + ;      
						"THEN CTH3.CTH_DESC01 " + ; 
					"WHEN CTH2.CTH_CLVL IS NOT NULL " + ;     
						"THEN CTH2.CTH_DESC01 " + ; 
					"ELSE CTH1.CTH_DESC01 " + ;  
				"END AS DESC_MOEDA6, " + ;      
				"CASE " + ;  
					"WHEN CTH5.CTH_CLVL IS NOT NULL " + ;      
						"THEN CTH5.CTH_DESC01 " + ; 
					"WHEN CTH4.CTH_CLVL IS NOT NULL " + ;     
						"THEN CTH4.CTH_DESC01 " + ; 
					"WHEN CTH3.CTH_CLVL IS NOT NULL " + ;      
						"THEN CTH3.CTH_DESC01 " + ; 
					"WHEN CTH2.CTH_CLVL IS NOT NULL " + ;      
						"THEN CTH2.CTH_DESC01 " + ; 
					"ELSE CTH1.CTH_DESC01 " + ;  
				"END AS DESC_MOEDA5, " + ;      
				"CASE " + ;  
					"WHEN CTH4.CTH_CLVL IS NOT NULL " + ;  
						"THEN CTH4.CTH_DESC01 " + ; 
					"WHEN CTH3.CTH_CLVL IS NOT NULL " + ;      
						"THEN CTH3.CTH_DESC01 " + ; 
					"WHEN CTH2.CTH_CLVL IS NOT NULL " + ;      
						"THEN CTH2.CTH_DESC01 " + ; 
					"ELSE CTH1.CTH_DESC01 " + ;  
				"END AS DESC_MOEDA4, " + ;     
				"CASE " + ;  
					"WHEN CTH3.CTH_CLVL IS NOT NULL " + ;     
						"THEN CTH3.CTH_DESC01 " + ; 
					"WHEN CTH2.CTH_CLVL IS NOT NULL " + ;      
						"THEN CTH2.CTH_DESC01 " + ; 
					"ELSE CTH1.CTH_DESC01 " + ; 
				"END AS DESC_MOEDA3, " + ;    
				"CASE " + ;  
					"WHEN CTH2.CTH_CLVL IS NOT NULL " + ;      
						"THEN CTH2.CTH_DESC01 " + ; 
					"ELSE CTH1.CTH_DESC01 " + ;  
				"END AS DESC_MOEDA2, " + ;      
				"CTH1.CTH_DESC01 AS DESC_MOEDA1, " + ;    
				"CASE " + ;    										 				 										
					"WHEN CTH11.CTH_CLVL IS NOT NULL " + ;										
						"THEN CTH11.CTH_CLVL		 " + ;					
					"WHEN CTH10.CTH_CLVL IS NOT NULL " + ;												
						"THEN CTH10.CTH_CLVL		 " + ;									
					"WHEN CTH9.CTH_CLVL IS NOT NULL " + ;													
						"THEN CTH9.CTH_CLVL		 " + ;								
					"WHEN CTH8.CTH_CLVL IS NOT NULL " + ;												
						"THEN CTH8.CTH_CLVL		 " + ;									
					"WHEN CTH7.CTH_CLVL IS NOT NULL " + ;									
						"THEN CTH7.CTH_CLVL		 " + ;									
					"WHEN CTH6.CTH_CLVL IS NOT NULL " + ;														
						"THEN CTH6.CTH_CLVL		 " + ;								
					"WHEN CTH5.CTH_CLVL IS NOT NULL " + ;											
						"THEN CTH5.CTH_CLVL		 " + ;								
					"WHEN CTH4.CTH_CLVL IS NOT NULL " + ;												
						"THEN CTH4.CTH_CLVL		 " + ;											
					"WHEN CTH3.CTH_CLVL IS NOT NULL " + ;													
						"THEN CTH3.CTH_CLVL		 " + ;									
					"WHEN CTH2.CTH_CLVL IS NOT NULL " + ;											
						"THEN CTH2.CTH_CLVL		 " + ;										
					"ELSE CTH1.CTH_CLVL			 " + ;								
				"END AS COD_CLASSE_VALOR11, " + ;
				"CASE " + ; 
					"WHEN CTH10.CTH_CLVL IS NOT NULL " + ;   
						"THEN CTH10.CTH_CLVL " + ;     
					"WHEN CTH9.CTH_CLVL IS NOT NULL " + ; 
						"THEN CTH9.CTH_CLVL " + ;    
					"WHEN CTH8.CTH_CLVL IS NOT NULL " + ; 
						"THEN CTH8.CTH_CLVL " + ;    
					"WHEN CTH7.CTH_CLVL IS NOT NULL " + ; 
						"THEN CTH7.CTH_CLVL " + ;    
					"WHEN CTH6.CTH_CLVL IS NOT NULL " + ; 
						"THEN CTH6.CTH_CLVL " + ;    
					"WHEN CTH5.CTH_CLVL IS NOT NULL " + ; 
						"THEN CTH5.CTH_CLVL " + ;    
					"WHEN CTH4.CTH_CLVL IS NOT NULL " + ; 
						"THEN CTH4.CTH_CLVL " + ;    
					"WHEN CTH3.CTH_CLVL IS NOT NULL " + ; 
						"THEN CTH3.CTH_CLVL " + ;    
					"WHEN CTH2.CTH_CLVL IS NOT NULL " + ; 
						"THEN CTH2.CTH_CLVL " + ;    
					"ELSE CTH1.CTH_CLVL " + ;  
				"END AS COD_CLASSE_VALOR10, " + ;
				"CASE " + ; 
					"WHEN CTH9.CTH_CLVL IS NOT NULL " + ; 
						"THEN CTH9.CTH_CLVL " + ;     
					"WHEN CTH8.CTH_CLVL IS NOT NULL " + ; 
						"THEN CTH8.CTH_CLVL " + ;     
					"WHEN CTH7.CTH_CLVL IS NOT NULL " + ; 
						"THEN CTH7.CTH_CLVL " + ;     
					"WHEN CTH6.CTH_CLVL IS NOT NULL " + ; 
						"THEN CTH6.CTH_CLVL " + ;     
					"WHEN CTH5.CTH_CLVL IS NOT NULL " + ; 
						"THEN CTH5.CTH_CLVL " + ;     
					"WHEN CTH4.CTH_CLVL IS NOT NULL " + ; 
						"THEN CTH4.CTH_CLVL " + ;     
					"WHEN CTH3.CTH_CLVL IS NOT NULL " + ; 
						"THEN CTH3.CTH_CLVL " + ;     
					"WHEN CTH2.CTH_CLVL IS NOT NULL " + ; 
						"THEN CTH2.CTH_CLVL " + ;     
					"ELSE CTH1.CTH_CLVL " + ; 
				"END AS COD_CLASSE_VALOR9, " + ;
				"CASE " + ; 
					"WHEN CTH8.CTH_CLVL IS NOT NULL " + ;    
						"THEN CTH8.CTH_CLVL " + ;  
					"WHEN CTH7.CTH_CLVL IS NOT NULL " + ;    
						"THEN CTH7.CTH_CLVL " + ;  
					"WHEN CTH6.CTH_CLVL IS NOT NULL " + ;    
						"THEN CTH6.CTH_CLVL " + ;  
					"WHEN CTH5.CTH_CLVL IS NOT NULL " + ;    
						"THEN CTH5.CTH_CLVL " + ;  
					"WHEN CTH4.CTH_CLVL IS NOT NULL " + ;    
						"THEN CTH4.CTH_CLVL " + ;  
					"WHEN CTH3.CTH_CLVL IS NOT NULL " + ;    
						"THEN CTH3.CTH_CLVL " + ;  
					"WHEN CTH2.CTH_CLVL IS NOT NULL " + ;    
						"THEN CTH2.CTH_CLVL " + ;  
					"ELSE CTH1.CTH_CLVL " + ;    
				"END AS COD_CLASSE_VALOR8, " + ;  
				"CASE " + ; 
					"WHEN CTH7.CTH_CLVL IS NOT NULL " + ;    
						"THEN CTH7.CTH_CLVL " + ;  
					"WHEN CTH6.CTH_CLVL IS NOT NULL " + ;    
						"THEN CTH6.CTH_CLVL " + ;  
					"WHEN CTH5.CTH_CLVL IS NOT NULL " + ;    
						"THEN CTH5.CTH_CLVL " + ;  
					"WHEN CTH4.CTH_CLVL IS NOT NULL " + ;    
						"THEN CTH4.CTH_CLVL " + ;  
					"WHEN CTH3.CTH_CLVL IS NOT NULL " + ;    
						"THEN CTH3.CTH_CLVL " + ;  
					"WHEN CTH2.CTH_CLVL IS NOT NULL " + ;    
						"THEN CTH2.CTH_CLVL " + ;  
					"ELSE CTH1.CTH_CLVL " + ;    
				"END AS COD_CLASSE_VALOR7, " + ;  
				"CASE " + ; 
					"WHEN CTH6.CTH_CLVL IS NOT NULL " + ;    
						"THEN CTH6.CTH_CLVL " + ;  
					"WHEN CTH5.CTH_CLVL IS NOT NULL " + ;    
						"THEN CTH5.CTH_CLVL " + ;  
					"WHEN CTH4.CTH_CLVL IS NOT NULL " + ;    
						"THEN CTH4.CTH_CLVL " + ;  
					"WHEN CTH3.CTH_CLVL IS NOT NULL " + ;    
						"THEN CTH3.CTH_CLVL " + ;  
					"WHEN CTH2.CTH_CLVL IS NOT NULL " + ;    
						"THEN CTH2.CTH_CLVL " + ;  
					"ELSE CTH1.CTH_CLVL " + ;    
				"END AS COD_CLASSE_VALOR6, " + ;  
				"CASE " + ; 
					"WHEN CTH5.CTH_CLVL IS NOT NULL " + ;    
						"THEN CTH5.CTH_CLVL " + ;  
					"WHEN CTH4.CTH_CLVL IS NOT NULL " + ;    
						"THEN CTH4.CTH_CLVL " + ;  
					"WHEN CTH3.CTH_CLVL IS NOT NULL " + ;    
						"THEN CTH3.CTH_CLVL " + ;  
					"WHEN CTH2.CTH_CLVL IS NOT NULL " + ;    
						"THEN CTH2.CTH_CLVL " + ;  
					"ELSE CTH1.CTH_CLVL " + ;    
				"END AS COD_CLASSE_VALOR5, " + ;  
				"CASE " + ; 
					"WHEN CTH4.CTH_CLVL IS NOT NULL " + ;    
						"THEN CTH4.CTH_CLVL " + ;  
					"WHEN CTH3.CTH_CLVL IS NOT NULL " + ;    
						"THEN CTH3.CTH_CLVL " + ;  
					"WHEN CTH2.CTH_CLVL IS NOT NULL " + ;    
						"THEN CTH2.CTH_CLVL " + ;  
					"ELSE CTH1.CTH_CLVL " + ;    
				"END AS COD_CLASSE_VALOR4, " + ;  
				"CASE " + ; 
					"WHEN CTH3.CTH_CLVL IS NOT NULL " + ; 
						"THEN CTH3.CTH_CLVL " + ;  
					"WHEN CTH2.CTH_CLVL IS NOT NULL " + ;    
						"THEN CTH2.CTH_CLVL " + ;  
					"ELSE CTH1.CTH_CLVL " + ;    
				"END AS COD_CLASSE_VALOR3, " + ;  
				"CASE " + ; 
					"WHEN CTH2.CTH_CLVL IS NOT NULL " + ;    
						"THEN CTH2.CTH_CLVL " + ;  
					"ELSE CTH1.CTH_CLVL " + ;    
				"END AS COD_CLASSE_VALOR2, " + ;  
				"CTH1.CTH_CLVL AS COD_CLASSE_VALOR_1, " + ;
				"<<CODE_INSTANCE>> AS INSTANCIA " + ;
			  	"FROM <<CTH_COMPANY>> CTH1 " + ; 
			 	"LEFT JOIN <<CTH_COMPANY>> CTH2 " + ;  
			 		"ON CTH2.CTH_FILIAL = CTH1.CTH_FILIAL " + ;  
			 		"AND CTH2.CTH_CLSUP = CTH1.CTH_CLVL " + ;  
			 		"AND CTH2.CTH_CLVL <> CTH2.CTH_CLSUP " + ;     
			 		"AND CTH2.CTH_CLSUP <> ' ' " + ; 
			 		"AND CTH2.D_E_L_E_T_ = ' ' " + ; 
			 	"LEFT JOIN <<CTH_COMPANY>> CTH3 " + ; 
			 		"ON CTH3.CTH_FILIAL = CTH2.CTH_FILIAL " + ;  
			 		"AND CTH3.CTH_CLSUP = CTH2.CTH_CLVL " + ;    
			 		"AND CTH3.CTH_CLVL <> CTH3.CTH_CLSUP " + ;     
			 		"AND CTH3.D_E_L_E_T_ = ' ' " + ; 
			 	"LEFT JOIN <<CTH_COMPANY>> CTH4 " + ; 
			 		"ON CTH4.CTH_FILIAL = CTH3.CTH_FILIAL " + ;  
			 		"AND CTH4.CTH_CLSUP = CTH3.CTH_CLVL " + ;    
			 		"AND CTH4.CTH_CLVL <> CTH4.CTH_CLSUP " + ;     
			 		"AND CTH4.D_E_L_E_T_ = ' ' " + ; 
			 	"LEFT JOIN <<CTH_COMPANY>> CTH5 " + ; 
			 		"ON CTH5.CTH_FILIAL = CTH4.CTH_FILIAL " + ;  
			 		"AND CTH5.CTH_CLSUP = CTH4.CTH_CLVL " + ;    
			 		"AND CTH5.CTH_CLVL <> CTH5.CTH_CLSUP " + ;     
			 		"AND CTH5.D_E_L_E_T_ = ' ' " + ; 
			 	"LEFT JOIN <<CTH_COMPANY>> CTH6 " + ; 
			 		"ON CTH6.CTH_FILIAL = CTH5.CTH_FILIAL " + ;  
			 		"AND CTH6.CTH_CLSUP = CTH5.CTH_CLVL " + ;    
			 		"AND CTH6.CTH_CLVL <> CTH6.CTH_CLSUP " + ;     
			 		"AND CTH6.D_E_L_E_T_ = ' ' " + ; 
			 	"LEFT JOIN <<CTH_COMPANY>> CTH7 " + ; 
			 		"ON CTH7.CTH_FILIAL = CTH6.CTH_FILIAL " + ;  
			 		"AND CTH7.CTH_CLSUP = CTH6.CTH_CLVL " + ;    
			 		"AND CTH7.CTH_CLVL <> CTH7.CTH_CLSUP " + ;     
			 		"AND CTH7.D_E_L_E_T_ = ' ' " + ; 
			 	"LEFT JOIN <<CTH_COMPANY>> CTH8 " + ; 
			 		"ON CTH8.CTH_FILIAL = CTH7.CTH_FILIAL " + ;  
			 		"AND CTH8.CTH_CLSUP = CTH7.CTH_CLVL " + ;    
			 		"AND CTH8.CTH_CLVL <> CTH8.CTH_CLSUP " + ;     
			 		"AND CTH8.D_E_L_E_T_ = ' ' " + ; 
			 	"LEFT JOIN <<CTH_COMPANY>> CTH9 " + ; 
			 		"ON CTH9.CTH_FILIAL = CTH8.CTH_FILIAL " + ;  
			 		"AND CTH9.CTH_CLSUP = CTH8.CTH_CLVL " + ;    
			 		"AND CTH9.CTH_CLVL <> CTH9.CTH_CLSUP " + ;     
			 		"AND CTH9.D_E_L_E_T_ = ' ' " + ; 
			 	"LEFT JOIN <<CTH_COMPANY>> CTH10 " + ; 
			 		"ON CTH10.CTH_FILIAL = CTH9.CTH_FILIAL " + ; 
			 		"AND CTH10.CTH_CLSUP = CTH9.CTH_CLVL " + ;     
			 		"AND CTH10.CTH_CLVL <> CTH10.CTH_CLSUP " + ; 
			 		"AND CTH10.D_E_L_E_T_ = ' ' " + ; 
			 	"LEFT JOIN <<CTH_COMPANY>> CTH11 " + ; 
			 		"ON CTH11.CTH_FILIAL = CTH10.CTH_FILIAL " + ; 
			 		"AND CTH11.CTH_CLSUP = CTH10.CTH_CLVL " + ;      
			 		"AND CTH11.CTH_CLVL <> CTH11.CTH_CLSUP " + ; 
			 		"AND CTH11.D_E_L_E_T_ = ' ' " + ; 
			 	"WHERE (CTH1.CTH_CLVL = CTH1.CTH_CLSUP OR CTH1.CTH_CLSUP = ' ' ) " + ;
			 		"AND CTH1.D_E_L_E_T_ = ' '  " + ;
			 		"<<AND_XFILIAL_CTH1.CTH_FILIAL>> "

Return cQuery 