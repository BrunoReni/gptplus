<?xml version="1.0" encoding="ISO-8859-1" ?>
<EASYLINK>
    <SERVICE>
        <ID>003</ID>
        <DATA_SELECTION>
            <XML>
                <Message>
                    <Header>
                        <MessageType MessageVersion = '"1.0"'>"ShippingInstruction"</MessageType>
                        <DocumentIdentifier>cId</DocumentIdentifier>
                        <DateTime DateType = '"Document"'>cDtS6H4</DateTime>
                        <Parties>
                            <PartnerInformation PartnerRole = '"Sender"'>
                                <PartnerIdentifier Agency = '"AssignedBySender"'>cPartId</PartnerIdentifier>
                                <PartnerName>cPartName1</PartnerName>
                                <ContactInformation>
                                    <ContactName ContactType = "'Informational'">cContPartN</ContactName>
                                    <CommunicationValue CommunicationType = "cContPartT">cContPartV</CommunicationValue>
                                </ContactInformation>
                                <IF_02 COND = "!Empty(cPartEnd1)">
                                    <AddressInformation>
                                        <AddressLine>cPartEnd1</AddressLine>
                                        <IF_01 COND = "!Empty(cPartEnd2)">
                                            <AddressLine>cPartEnd2</AddressLine>
                                        </IF_01>
                                        <IF_02 COND = "!Empty(cPartEnd3)">
                                            <AddressLine>cPartEnd3</AddressLine>
                                        </IF_02>
                                        <IF_03 COND = "!Empty(cPartEnd4)">
                                            <AddressLine>cPartEnd4</AddressLine>
                                        </IF_03>
                                    </AddressInformation>
                                </IF_02>
                            </PartnerInformation>
                            <PartnerInformation PartnerRole = '"Recipient"'>
                                <PartnerIdentifier Agency = '"AssignedByRecipient"'>"INTTRA"</PartnerIdentifier>
                            </PartnerInformation>
                        </Parties>
                    </Header>
                    <MessageBody>
                        <MessageProperties>
                            <!--Identificação do Embarque -->
                            <ShipmentID>
                                <ShipmentIdentifier MessageStatus = "cOpcao">cID</ShipmentIdentifier>
                                <DocumentVersion>"000001"</DocumentVersion>
                            </ShipmentID>
                            <!--Data de criação do SI -->
                            <DateTime DateType = '"Document"'>cDtS8H4</DateTime>
                            <!--Tipo de Pagamento de Frete -->
                            <IF_01 COND = 'EEC->EEC_FRPPCC == "CC"'>
                                <ChargeCategory PrepaidorCollectIndicator = '"Collect"' ChargeType = '"AllCharges"'>""</ChargeCategory>
                            </IF_01>
                            <IF_02 COND = 'EEC->EEC_FRPPCC == "PP"'>
                                <ChargeCategory PrepaidorCollectIndicator = '"Prepaid"' ChargeType = '"AllCharges"'>""</ChargeCategory>
                            </IF_02>
                            <!--Valor Total do Embarque -->
                            <IF_03 COND = 'EXL->EXL_ENVVAL == "1"'>
                                <ShipmentDeclaredValue Currency = "cCodMoeISO">Str(EEC->EEC_TOTPED)</ShipmentDeclaredValue>
                            </IF_03>
                            <!--Detalhes da Carta de Crédito -->
                            <IF_04 COND = "!Empty(EEC->EEC_LC_NUM)">
                                <LetterOfCreditDetails>
                                    <LetterOfCreditNumber>Left(EEC->EEC_LC_NUM,35)</LetterOfCreditNumber>
                                    <IF_01 COND = "!Empty(EEC->EEC_SL_LC)">
                                        <DateTime DateType = '"IssueDate"'>DtoS(EEC->EEC_SL_LC)</DateTime>
                                    </IF_01>
                                    <IF_02 COND = "!Empty(cLCDtVen)">
                                        <DateTime DateType = '"ExpiryDate"'>cLCDtVen</DateTime>
                                    </IF_02>
                                </LetterOfCreditDetails>
                            </IF_04>
                            <!--Localidades do B/L-->
                            <BlLocations>
                                <!--Local de Pagamento de Frete -->
                                <IF COND = "!Empty(cLcFreLc)">
                                    <Location LocationType = '"FreightPaymentLocation"'>
                                        <LocationCode Agency = '"UN"'>cLcFreLc</LocationCode>
                                        <LocationName>cLcFreNm</LocationName>
                                    </Location>
                                </IF>
                                <!--BL Release -->
                                <Location LocationType = '"BillOfLadingRelease"'>
                                    <LocationCode Agency = '"UN"'>cPtOriLC</LocationCode>
                                    <LocationName>cPtOriNM</LocationName>
                                </Location>
                            </BlLocations>
                            <!--Número do Booking -->
                            <IF_05 COND = "!Empty(EXL->EXL_BOOK)">
                                <ReferenceInformation ReferenceType = '"BookingNumber"'>Left(EXL->EXL_BOOK,35)</ReferenceInformation>
                            </IF_05>
                            <!--Número do BL -->
                            <IF_06 COND = "!Empty(EEC->EEC_NRCONH)">
                                <ReferenceInformation ReferenceType = '"BillOfLadingNumber"'>Left(EEC->EEC_NRCONH,35)</ReferenceInformation>
                            </IF_06>
                            <!--Número de Referência do Despachante -->
                            <IF_07 COND = "!Empty(cDespCodIn)">
                                <ReferenceInformation ReferenceType = '"BrokeReferenceNumber"'>cDespCodIn</ReferenceInformation>
                            </IF_07>
                            <!--Número de Referência do Importador -->
                            <IF_08 COND = "!Empty(EEC->EEC_REFIMP)">
                                <ReferenceInformation ReferenceType = '"ConsigneeOrderNumber"'>Left(EEC->EEC_REFIMP,35)</ReferenceInformation>
                            </IF_08>
                            <!--Número de Contrato com o Armador -->
                            <IF_09 COND = "!Empty(cContArm)">
                                <ReferenceInformation ReferenceType = '"ContractNumber"'>cContArm</ReferenceInformation>
                            </IF_09>
                            <!--Identificação do Exportador -->
                            <ReferenceInformation ReferenceType = '"ExportersReferenceNumber"'>cPreemb</ReferenceInformation>
                            <!--Referencia do Freight Forwarder -->
                            <IF_10 COND = "!Empty(cFFref)">
                                <ReferenceInformation ReferenceType = '"FreightForwarderReference"'>cFFref</ReferenceInformation>
                            </IF_10>
                            <!--Invoices -->
                            <FOR_01
                                INI = "1"
                                TO = "Len(aInvoices)"
                                VAR = '"nInc"'
                                STEP = "1"
                                REPL = '"1"'>
                                <ReferenceInformation ReferenceType = '"InvoiceNumber"'>aInvoices[nInc]</ReferenceInformation>
                            </FOR_01>
                            <!--Pedidos -->
                            <FOR_02
                                INI = "1"
                                TO = "Len(aPedidos)"
                                VAR = '"nInc"'
                                STEP = "1"
                                REPL = '"1"'>
                                <ReferenceInformation ReferenceType = '"PurchaseOrderNumber"'>aPedidos[nInc]</ReferenceInformation>
                            </FOR_02>
                            <!--Identificação do Embarcador -->
                            <ReferenceInformation ReferenceType = '"ShipperIdentifyingNumber"'>cPreemb</ReferenceInformation>
                            <IF_11 COND = "!Empty(cSICOM) .Or.  !Empty(cBLCLA1) .Or. !Empty(cBLCLA2) .Or. !Empty(cBLCLA3) ">
                                <Instructions>
                                    <!--Comentários do Shipping Instructions-->
                                    <IF_01 COND = "!Empty(cSICOM)">
                                        <ShipmentComments CommentType = '"General"'>cSICOM</ShipmentComments>
                                    </IF_01>
                                    <!--Clausula de BL 01 -->
                                    <IF_02 COND = "!Empty(cBLCLA1)">
                                        <ShipmentComments CommentType = '"BlClause"' ClauseType = "cBLCLA1">cBLCLA1C</ShipmentComments>
                                    </IF_02>
                                    <!--Clausula de BL 02 -->
                                    <IF_03 COND = "!Empty(cBLCLA2)">
                                        <ShipmentComments CommentType = '"BlClause"' ClauseType = "cBLCLA2">cBLCLA2C</ShipmentComments>
                                    </IF_03>
                                    <!--Clausula de BL 03 -->
                                    <IF_04 COND = "!Empty(cBLCLA3)">
                                        <ShipmentComments CommentType = '"BlClause"' ClauseType = "cBLCLA3">cBLCLA3C</ShipmentComments>
                                    </IF_04>
                                </Instructions>
                            </IF_11>
                            <ControlTotal>
                                <!--Total de Containeres -->
                                <NumberOfEquipment>cTotCon</NumberOfEquipment>
                                <!--Total de Embalagens Externas-->
                                <NumberOfPackages>cTotEmb</NumberOfPackages>
                                <!--Peso Bruto Total -->
                                <GrossWeight UOM = '"KGM"'>cPesoBRKG</GrossWeight>
                                <!-- <GrossVolume UOM = '"MTQ"'>cVolume</GrossVolume> -->
                            </ControlTotal>
                            <IF_12 COND = 'EXL->EXL_TIPMOV == "1"'>
                                <HaulageDetails MovementType = '"PortToPort"' ServiceType = 'If(EXL->EXL_TPSERV == "L","LessThanFullLoad","FullLoad")'>""</HaulageDetails>
                            </IF_12>
                            <IF_13 COND = 'EXL->EXL_TIPMOV == "2"'>
                                <HaulageDetails MovementType = '"DoorToPort"' ServiceType = 'If(EXL->EXL_TPSERV == "L","LessThanFullLoad","FullLoad")'>""</HaulageDetails>
                            </IF_13>
                            <IF_14 COND = 'EXL->EXL_TIPMOV == "3"'>
                                <HaulageDetails MovementType = '"PortToDoor"' ServiceType = 'If(EXL->EXL_TPSERV == "L","LessThanFullLoad","FullLoad")'>""</HaulageDetails>
                            </IF_14>
                            <IF_15 COND = 'EXL->EXL_TIPMOV == "4"'>
                                <HaulageDetails MovementType = '"DoorToDoor"' ServiceType = 'If(EXL->EXL_TPSERV == "L","LessThanFullLoad","FullLoad")'>""</HaulageDetails>
                            </IF_15>
                            <TransportationDetails TransportStage = '"Main"' TransportMode = '"Maritime"'>
                                <ConveyanceInformation>
                                    <IF_01 COND = "!Empty(cNvNome)">
                                        <ConveyanceName>cNvNome</ConveyanceName>
                                    </IF_01>
                                    <IF_02 COND = "!Empty(cNvViagem)">
                                        <VoyageTripNumber>cNvViagem</VoyageTripNumber>
                                    </IF_02>
                                    <CarrierSCAC>cArmID</CarrierSCAC>
                                </ConveyanceInformation>
                                <!--Localidades -->
                                <!--Local de Retirada -->
                                <Location LocationType = '"PlaceOfReceipt"'>
                                    <LocationCode Agency = '"UN"'>cLcOriLC</LocationCode>
                                    <LocationName>cLcOriNM</LocationName>
                                </Location>
                                <!--Porto de Origem -->
                                <Location LocationType = '"PortOfLoading"'>
                                    <LocationCode Agency = '"UN"'>cPtOriLC</LocationCode>
                                    <LocationName>cPtOriNM</LocationName>
                                </Location>
                                <!--Porto de Destino -->
                                <Location LocationType = '"PortOfDischarge"'>
                                    <LocationCode Agency = '"UN"'>cPtDesLC</LocationCode>
                                    <LocationName>cPtDesNM</LocationName>
                                </Location>
                                <!--Local de Entrega -->
                                <IF COND = "!Empty(EXL->EXL_LOCENT)">
                                    <Location LocationType = '"PlaceOfDelivery"'>
                                        <LocationCode Agency = '"UN"'>cLcDesLC</LocationCode>
                                        <LocationName>cLcDesNM</LocationName>
                                    </Location>
                                </IF>
                            </TransportationDetails>
                            <!--Participantes -->
                            <Parties>
                                <!--Armador -->
                                <PartnerInformation PartnerRole = '"Carrier"'>
                                    <PartnerIdentifier Agency = '"AssignedBySender"'>cArmID</PartnerIdentifier>
                                    <PartnerName>cArmName1</PartnerName>
                                </PartnerInformation>
                                <!--Consignatário -->
                                <IF_01 COND = "!Empty(cConsName1)">
                                    <PartnerInformation PartnerRole = '"Consignee"'>
                                        <IF_01 COND = "!Empty(cConsID)">
                                            <PartnerIdentifier Agency = '"AssignedBySender"'>cConsID</PartnerIdentifier>
                                        </IF_01>
                                        <PartnerName>cConsName1</PartnerName>
                                        <!--Contato -->
                                        <IF_02 COND = "!Empty(cConsPartN)">
                                            <ContactInformation>
                                                <ContactName ContactType = "'Informational'">cConsPartN</ContactName>
                                                <CommunicationValue CommunicationType = "cConsPartT">cConsPartV</CommunicationValue>
                                            </ContactInformation>
                                        </IF_02>
                                        <IF_03 COND = "!Empty(cConsEnd1)">
                                            <AddressInformation>
                                                <AddressLine>cConsEnd1</AddressLine>
                                                <IF_01 COND = "!Empty(cConsEnd2)">
                                                    <AddressLine>cConsEnd2</AddressLine>
                                                </IF_01>
                                                <IF_02 COND = "!Empty(cConsEnd3)">
                                                    <AddressLine>cConsEnd3</AddressLine>
                                                </IF_02>
                                                <IF_03 COND = "!Empty(cConsEnd4)">
                                                    <AddressLine>cConsEnd4</AddressLine>
                                                </IF_03>
                                            </AddressInformation>
                                        </IF_03>
                                    </PartnerInformation>
                                </IF_01>
                                <PartnerInformation PartnerRole = '"Exporter"'>
                                    <PartnerIdentifier Agency = '"AssignedBySender"'>cPartID</PartnerIdentifier>
                                    <PartnerName>cPartName1</PartnerName>
                                    <!--Contato -->
                                    <ContactInformation>
                                        <ContactName ContactType = "'Informational'">cContPartN</ContactName>
                                        <CommunicationValue CommunicationType = "cContPartT">cContPartV</CommunicationValue>
                                    </ContactInformation>
                                    <IF_02 COND = "!Empty(cPartEnd1)">
                                        <AddressInformation>
                                            <AddressLine>cPartEnd1</AddressLine>
                                            <IF_01 COND = "!Empty(cPartEnd2)">
                                                <AddressLine>cPartEnd2</AddressLine>
                                            </IF_01>
                                            <IF_02 COND = "!Empty(cPartEnd3)">
                                                <AddressLine>cPartEnd3</AddressLine>
                                            </IF_02>
                                            <IF_03 COND = "!Empty(cPartEnd4)">
                                                <AddressLine>cPartEnd4</AddressLine>
                                            </IF_03>
                                        </AddressInformation>
                                    </IF_02>
                                </PartnerInformation>
                                <!--Agente no Exterior. FreightForwarder -->
                                <IF_02 COND = "!Empty(cFFName1)">
                                    <PartnerInformation PartnerRole = '"FreightForwarder"'>
                                        <IF COND = "!Empty(cFFID)">
                                            <PartnerIdentifier Agency = '"AssignedBySender"'>cFFID</PartnerIdentifier>
                                        </IF>
                                        <PartnerName>cFFName1</PartnerName>
                                        <!--Contato -->
                                        <ContactInformation>
                                            <ContactName ContactType = "'Informational'">cFFPartN</ContactName>
                                            <CommunicationValue CommunicationType = "cFFPartT">cFFPartV</CommunicationValue>
                                        </ContactInformation>
                                        <IF_02 COND = "!Empty(cFFEnd1)">
                                            <AddressInformation>
                                                <AddressLine>cFFEnd1</AddressLine>
                                                <IF_01 COND = "!Empty(cFFEnd2)">
                                                    <AddressLine>cFFEnd2</AddressLine>
                                                </IF_01>
                                                <IF_02 COND = "!Empty(cFFEnd3)">
                                                    <AddressLine>cFFEnd3</AddressLine>
                                                </IF_02>
                                                <IF_03 COND = "!Empty(cFFEnd4)">
                                                    <AddressLine>cFFEnd4</AddressLine>
                                                </IF_03>
                                            </AddressInformation>
                                        </IF_02>
                                    </PartnerInformation>
                                </IF_02>
                                <!--Notify Principal -->
                                <IF_03 COND = "!Empty(cNot1Name1)">
                                    <PartnerInformation PartnerRole = '"NotifyParty"'>
                                        <IF_01 COND = "!Empty(cNot1ID)">
                                            <PartnerIdentifier Agency = '"AssignedBySender"'>cNot1ID</PartnerIdentifier>
                                        </IF_01>
                                        <PartnerName>cNot1Name1</PartnerName>
                                        <IF_02 COND = "!Empty(cNot1PartN)">
                                            <ContactInformation>
                                                <ContactName ContactType = "'Informational'">cNot1PartN</ContactName>
                                                <CommunicationValue CommunicationType = "cNot1PartT">cNot1PartV</CommunicationValue>
                                            </ContactInformation>
                                        </IF_02>
                                        <IF_03 COND = "!Empty(cNot1End1)">
                                            <AddressInformation>
                                                <AddressLine>cNot1End1</AddressLine>
                                                <IF_01 COND = "!Empty(cNot1End2)">
                                                    <AddressLine>cNot1End2</AddressLine>
                                                </IF_01>
                                                <IF_02 COND = "!Empty(cNot1End3)">
                                                    <AddressLine>cNot1End3</AddressLine>
                                                </IF_02>
                                                <IF_03 COND = "!Empty(cNot1End4)">
                                                    <AddressLine>cNot1End4</AddressLine>
                                                </IF_03>
                                            </AddressInformation>
                                        </IF_03>
                                    </PartnerInformation>
                                </IF_03>
                                <!--Notify Adicional1 -->
                                <IF_04 COND = "!Empty(cNot2Name1)">
                                    <PartnerInformation PartnerRole = '"NotifyParty2"'>
                                        <IF COND = "!Empty(cNot2ID)">
                                            <PartnerIdentifier Agency = '"AssignedBySender"'>cNot2ID</PartnerIdentifier>
                                        </IF>
                                        <PartnerName>cNot2Name1</PartnerName>
                                        <ContactInformation>
                                            <ContactName ContactType = "'Informational'">cNot2PartN</ContactName>
                                            <CommunicationValue CommunicationType = "cNot2PartT">cNot2PartV</CommunicationValue>
                                        </ContactInformation>
                                        <IF_02 COND = "!Empty(cNot2End1)">
                                            <AddressInformation>
                                                <AddressLine>cNot2End1</AddressLine>
                                                <IF_01 COND = "!Empty(cNot2End2)">
                                                    <AddressLine>cNot2End2</AddressLine>
                                                </IF_01>
                                                <IF_02 COND = "!Empty(cNot2End3)">
                                                    <AddressLine>cNot2End3</AddressLine>
                                                </IF_02>
                                                <IF_03 COND = "!Empty(cNot2End4)">
                                                    <AddressLine>cNot2End4</AddressLine>
                                                </IF_03>
                                            </AddressInformation>
                                        </IF_02>
                                    </PartnerInformation>
                                </IF_04>
                                <!--Notify Adicional2 -->
                                <IF_05 COND = "!Empty(cNot3Name1)">
                                    <PartnerInformation PartnerRole = '"NotifyParty3"'>
                                        <IF COND = "!Empty(cNot3ID)">
                                            <PartnerIdentifier Agency = '"AssignedBySender"'>cNot3ID</PartnerIdentifier>
                                        </IF>
                                        <PartnerName>cNot3Name1</PartnerName>
                                        <ContactInformation>
                                            <ContactName ContactType = "'Informational'">cNot3PartN</ContactName>
                                            <CommunicationValue CommunicationType = "cNot3PartT">cNot3PartV</CommunicationValue>
                                        </ContactInformation>
                                        <IF_02 COND = "!Empty(cNot3End1)">
                                            <AddressInformation>
                                                <AddressLine>cNot3End1</AddressLine>
                                                <IF_01 COND = "!Empty(cNot3End2)">
                                                    <AddressLine>cNot3End2</AddressLine>
                                                </IF_01>
                                                <IF_02 COND = "!Empty(cNot3End3)">
                                                    <AddressLine>cNot3End3</AddressLine>
                                                </IF_02>
                                                <IF_03 COND = "!Empty(cNot3End4)">
                                                    <AddressLine>cNot3End4</AddressLine>
                                                </IF_03>
                                            </AddressInformation>
                                        </IF_02>
                                    </PartnerInformation>
                                </IF_05>
                                <PartnerInformation PartnerRole = '"Requestor"'>
                                    <PartnerIdentifier Agency = '"AssignedBySender"'>cPartID</PartnerIdentifier>
                                    <PartnerName>cPartName1</PartnerName>
                                    <!--Contato -->
                                    <ContactInformation>
                                        <ContactName ContactType = "'Informational'">cContPartN</ContactName>
                                        <CommunicationValue CommunicationType = "cContPartT">cContPartV</CommunicationValue>
                                    </ContactInformation>
                                    <IF_02 COND = "!Empty(cPartEnd1)">
                                        <AddressInformation>
                                            <AddressLine>cPartEnd1</AddressLine>
                                            <IF_01 COND = "!Empty(cPartEnd2)">
                                                <AddressLine>cPartEnd2</AddressLine>
                                            </IF_01>
                                            <IF_02 COND = "!Empty(cPartEnd3)">
                                                <AddressLine>cPartEnd3</AddressLine>
                                            </IF_02>
                                            <IF_03 COND = "!Empty(cPartEnd4)">
                                                <AddressLine>cPartEnd4</AddressLine>
                                            </IF_03>
                                        </AddressInformation>
                                    </IF_02>
                                    <IF_01 COND = "!Empty(cTipoBl) .And. Val(cQtdBl) > 0">
                                        <DocumentationRequirements>
                                            <Documents DocumentType = "cTipoBl" Freighted = "cImpFre"/>
                                            <Quantity>cQtdBl</Quantity>
                                        </DocumentationRequirements>
                                        <IF_01 COND = "cTipoBl == 'BillOfLadingOriginal'">
                                            <DocumentationRequirements>
                                                <Documents DocumentType = '"BillOfLadingCopy"' Freighted = "cImpFre"/>
                                                <Quantity>cQtdBlC</Quantity>
                                            </DocumentationRequirements>
                                        </IF_01>
                                    </IF_01>
                                </PartnerInformation>
                                <!--Shipper -->
                                <PartnerInformation PartnerRole = '"Shipper"'>
                                    <PartnerIdentifier Agency = '"AssignedBySender"'>cPartID</PartnerIdentifier>
                                    <PartnerName>cPartName1</PartnerName>
                                    <!--Contato -->
                                    <ContactInformation>
                                        <ContactName ContactType = "'Informational'">cContPartN</ContactName>
                                        <CommunicationValue CommunicationType = "cContPartT">cContPartV</CommunicationValue>
                                    </ContactInformation>
                                    <IF_02 COND = "!Empty(cPartEnd1)">
                                        <AddressInformation>
                                            <AddressLine>cPartEnd1</AddressLine>
                                            <IF_01 COND = "!Empty(cPartEnd2)">
                                                <AddressLine>cPartEnd2</AddressLine>
                                            </IF_01>
                                            <IF_02 COND = "!Empty(cPartEnd3)">
                                                <AddressLine>cPartEnd3</AddressLine>
                                            </IF_02>
                                            <IF_03 COND = "!Empty(cPartEnd4)">
                                                <AddressLine>cPartEnd4</AddressLine>
                                            </IF_03>
                                        </AddressInformation>
                                    </IF_02>
                                </PartnerInformation>
                            </Parties>
                        </MessageProperties>
                        <MessageDetails>
                            <!--Detalhes de Containeres -->
                            <FOR_01
                                INI = "1"
                                TO = "Len(aContainer)"
                                VAR = '"nInc"'
                                STEP = "1"
                                REPL = '"1"'>
                                <EquipmentDetails>
                                    <LineNumber>nInc</LineNumber>
                                    <EquipmentIdentifier EquipmentSupplier = "aContainer[nInc][1]">aContainer[nInc][2]</EquipmentIdentifier>
                                    <EquipmentType>
                                        <EquipmentTypeCode>aContainer[nInc][3]</EquipmentTypeCode>
                                        <EquipmentDescription>aContainer[nInc][4]</EquipmentDescription>
                                    </EquipmentType>
                                    <EquipmentGrossWeight UOM = '"KGM"'>aContainer[nInc][5]</EquipmentGrossWeight>
                                    <EquipmentGrossVolume UOM = '"MTQ"'>aContainer[nInc][14]</EquipmentGrossVolume>
                                    <IF_03 COND = "aContainer[nInc][6] = '1'  .And. !Empty(aContainer[nInc][7])">
                                        <EquipmentTemperature UOM = '"CEL"'>aContainer[nInc][7]</EquipmentTemperature>
                                    </IF_03>
                                    <IF_04 COND = "aContainer[nInc][6] = '1' .And. !Empty(aContainer[nInc][8]) ">
                                        <EquipmentAirFlow UOM = '"CBM"'>aContainer[nInc][8]</EquipmentAirFlow>
                                    </IF_04>
                                    <IF_05 COND = "!Empty(aContainer[nInc][10])">
                                        <EquipmentSeal SealingParty = "aContainer[nInc][9]">aContainer[nInc][10]</EquipmentSeal>
                                    </IF_05>
                                    <IF_06 COND = "!Empty(aContainer[nInc][11])">
                                        <EquipmentComments CommentType = '"Equipment"'>aContainer[nInc][11]</EquipmentComments>
                                    </IF_06>
                                    <IF_07 COND = "!Empty(aContainer[nInc][12]) .And. aContainer[nInc][6] = '1' ">
                                        <EquipmentComments CommentType = '"Temperature"'>aContainer[nInc][12]</EquipmentComments>
                                    </IF_07>
                                </EquipmentDetails>
                            </FOR_01>
                            <!--Detalhes das Embalagens e Mercadorias -->
                            <!--Agupado por itens com mesma embalagem externa pertencentes ao mesmo container -->
                            <FOR
                                INI = "1"
                                TO = "Len(aPackages)"
                                VAR = '"nInc"'
                                STEP = "1"
                                REPL = '"1"'>
                                <GoodsDetails>
                                    <LineNumber>nInc</LineNumber>
                                    <PackageDetail Level = '"Outer"'>
                                        <NumberOfPackages>Str(aPackages[nInc][5])</NumberOfPackages>
                                        <PackageTypeCode>aPackages[nInc][3]</PackageTypeCode>
                                    </PackageDetail>
                                    <PackageDetailComments CommentType = '"GoodsDescription"'>StrTran(aPackages[nInc][2], Chr(13)+Chr(10), " ")</PackageDetailComments>
                                    <!--<PackageDetailGrossVolume UOM = '"MTQ"'>Transform(aPackages[nInc][7],"99999999999999.999")</PackageDetailGrossVolume>-->
                                    <IF_01 COND = 'Empty(EEC->EEC_UNIDAD) .or. EEC->EEC_UNIDAD == "KG"'>
                                        <PackageDetailGrossWeight UOM = '"KGM"'>Transform(aPackages[nInc][6],"99999999999999.999")</PackageDetailGrossWeight>
                                    </IF_01>
                                    <IF_02 COND = '!Empty(EEC->EEC_UNIDAD) .and. EEC->EEC_UNIDAD != "KG"'>
                                        <PackageDetailGrossWeight UOM = '"KGM"'>Transform(AvTransUnid(EEC->EEC_UNIDAD,"KG","",aPackages[nInc][6],.F.),"99999999999999.999")</PackageDetailGrossWeight>
                                    </IF_02>
                                    <DetailsReferenceInformation ReferenceType = '"PurchaseOrderNumber"'>aPackages[nInc][9]</DetailsReferenceInformation>
                                    <IF_03 COND = "Len(aMarks) > 0">
                                        <FOR
                                            INI = "1"
                                            TO = "Len(aMarks)"
                                            VAR = "'nMark1'"
                                            STEP = "1"
                                            REPL = "'1'">
                                            <PackageMarks>
                                                <FOR
                                                    INI = "1"
                                                    TO = "Len(aMarks[nMark1])"
                                                    VAR = "'nMark2'"
                                                    STEP = "1"
                                                    REPL = "'1'">
                                                    <Marks>aMarks[nMark1][nMark2]</Marks>
                                                </FOR>
                                            </PackageMarks>
                                        </FOR>
                                    </IF_03>
                                    <FOR_01
                                        INI = "1"
                                        TO = "Len(aPackages[nInc][8])"
                                        VAR = '"nInc2"'
                                        STEP = "1"
                                        REPL = '"1"'>
                                        <SplitGoodsDetails>
                                            <EquipmentIdentifier>aPackages[nInc][8][nInc2][1]</EquipmentIdentifier>
                                            <SplitGoodsNumberOfPackages>Str(aPackages[nInc][8][nInc2][2])</SplitGoodsNumberOfPackages>
                                            <!-- <SplitGoodsGrossVolume UOM = '"MTQ"'>Transform(aPackages[nInc][8][nInc2][4],"99999999999999.999")</SplitGoodsGrossVolume> -->
                                            <IF_01 COND = 'Empty(EEC->EEC_UNIDAD) .or. EEC->EEC_UNIDAD == "KG"'>
                                                <SplitGoodsGrossWeight UOM = '"KGM"'>Transform(AvTransUnid(EEC->EEC_UNIDAD,"KG","",aPackages[nInc][8][nInc2][3],.F.),"99999999999999.999")</SplitGoodsGrossWeight>
                                            </IF_01>
                                            <IF_02 COND = '!Empty(EEC->EEC_UNIDAD) .and. EEC->EEC_UNIDAD != "KG"'>
                                                <SplitGoodsGrossWeight UOM = '"KGM"'>Transform(aPackages[nInc][8][nInc2][3],"99999999999999.999")</SplitGoodsGrossWeight>
                                            </IF_02>
                                        </SplitGoodsDetails>
                                    </FOR_01>
                                    <!--Mercadorias Perigosas -->
                                    <ALIAS_02>"EYJ"</ALIAS_02>
                                    <ORDER_02>1</ORDER_02>
                                    <SEEK_02>xFilial("EYJ")+AvKey(aPackages[nInc][10], "EYJ_COD")</SEEK_02>
                                    <IF_05 COND = "EYJ->(!EOF()) .and. !Empty(EYJ->EYJ_GRAVID)">
                                        <IF_01 COND = 'EYJ->EYJ_GRAVID == "1"'>
                                            <HazardousGoods PackingGroupCode = '"MinorDanger"'>
                                                <IF_01 COND = "!Empty(EYJ->EYJ_IMO)">
                                                    <IMOClassCode>Left(EYJ->EYJ_IMO,7)</IMOClassCode>
                                                </IF_01>
                                                <IF_02 COND = "!Empty(EYJ->EYJ_IMDG)">
                                                    <IMDGPageNumber>Left(EYJ->EYJ_IMDG,7)</IMDGPageNumber>
                                                </IF_02>
                                                <IF_03 COND = "!Empty(EYJ->EYJ_UNDG)">
                                                    <UNDGNumber>Left(EYJ->EYJ_UNDG,4)</UNDGNumber>
                                                </IF_03>
                                                <IF_04 COND = "!Empty(EYJ->EYJ_TEMRIS)">
                                                    <FlashpointTemperature UOM = '"CEL"'>StrZero(EYJ->EYJ_TEMRIS, 3)</FlashpointTemperature>
                                                </IF_04>
                                                <IF_05 COND = "!Empty(EYJ->EYJ_CCOMPE)">
                                                    <HazardousGoodsComments CommentType = '"General"'>EYJ->(MSMM(EYJ_CCOMPE,AVSX3("EYJ_COMPER",3),,,3))</HazardousGoodsComments>
                                                </IF_05>
                                                <IF_06 COND = "!Empty(EYJ->EYJ_CTNAME) .and. !Empty(EYJ->EYJ_CTTEL)">
                                                    <EmergencyResponseContact>
                                                        <ContactInformation>
                                                            <ContactName ContactType = "'Emergency'">Left(EYJ->EYJ_CTNAME,35)</ContactName>
                                                            <CommunicationValue CommunicationType = '"Telephone"'>Left(EYJ->EYJ_CTTEL,35)</CommunicationValue>
                                                        </ContactInformation>
                                                    </EmergencyResponseContact>
                                                </IF_06>
                                            </HazardousGoods>
                                        </IF_01>
                                        <IF_02 COND = 'EYJ->EYJ_GRAVID == "2"'>
                                            <HazardousGoods PackingGroupCode = '"MediumDanger"'>
                                                <IF_01 COND = "!Empty(EYJ->EYJ_IMO)">
                                                    <IMOClassCode>Left(EYJ->EYJ_IMO,7)</IMOClassCode>
                                                </IF_01>
                                                <IF_02 COND = "!Empty(EYJ->EYJ_IMDG)">
                                                    <IMDGPageNumber>Left(EYJ->EYJ_IMDG,7)</IMDGPageNumber>
                                                </IF_02>
                                                <IF_03 COND = "!Empty(EYJ->EYJ_UNDG)">
                                                    <UNDGNumber>Left(EYJ->EYJ_UNDG,4)</UNDGNumber>
                                                </IF_03>
                                                <IF_04 COND = "!Empty(EYJ->EYJ_TEMRIS)">
                                                    <FlashpointTemperature UOM = '"CEL"'>StrZero(EYJ->EYJ_TEMRIS, 3)</FlashpointTemperature>
                                                </IF_04>
                                                <IF_05 COND = "!Empty(EYJ->EYJ_CCOMPE)">
                                                    <HazardousGoodsComments CommentType = '"General"'>EYJ->(MSMM(EYJ_CCOMPE,AVSX3("EYJ_COMPER",3),,,3))</HazardousGoodsComments>
                                                </IF_05>
                                                <IF_06 COND = "!Empty(EYJ->EYJ_CTNAME) .and. !Empty(EYJ->EYJ_CTTEL)">
                                                    <EmergencyResponseContact>
                                                        <ContactInformation>
                                                            <ContactName ContactType = "'Emergency'">Left(EYJ->EYJ_CTNAME,35)</ContactName>
                                                            <CommunicationValue CommunicationType = '"Telephone"'>Left(EYJ->EYJ_CTTEL,35)</CommunicationValue>
                                                        </ContactInformation>
                                                    </EmergencyResponseContact>
                                                </IF_06>
                                            </HazardousGoods>
                                        </IF_02>
                                        <IF_03 COND = 'EYJ->EYJ_GRAVID == "3"'>
                                            <HazardousGoods PackingGroupCode = '"GreatDanger"'>
                                                <IF_01 COND = "!Empty(EYJ->EYJ_IMO)">
                                                    <IMOClassCode>Left(EYJ->EYJ_IMO,7)</IMOClassCode>
                                                </IF_01>
                                                <IF_02 COND = "!Empty(EYJ->EYJ_IMDG)">
                                                    <IMDGPageNumber>Left(EYJ->EYJ_IMDG,7)</IMDGPageNumber>
                                                </IF_02>
                                                <IF_03 COND = "!Empty(EYJ->EYJ_UNDG)">
                                                    <UNDGNumber>Left(EYJ->EYJ_UNDG,4)</UNDGNumber>
                                                </IF_03>
                                                <IF_04 COND = "!Empty(EYJ->EYJ_TEMRIS)">
                                                    <FlashpointTemperature UOM = '"CEL"'>StrZero(EYJ->EYJ_TEMRIS, 3)</FlashpointTemperature>
                                                </IF_04>
                                                <IF_05 COND = "!Empty(EYJ->EYJ_CCOMPE)">
                                                    <HazardousGoodsComments CommentType = '"General"'>EYJ->(MSMM(EYJ_CCOMPE,AVSX3("EYJ_COMPER",3),,,3))</HazardousGoodsComments>
                                                </IF_05>
                                                <IF_06 COND = "!Empty(EYJ->EYJ_CTNAME) .and. !Empty(EYJ->EYJ_CTTEL)">
                                                    <EmergencyResponseContact>
                                                        <ContactInformation>
                                                            <ContactName ContactType = "'Emergency'">Left(EYJ->EYJ_CTNAME,35)</ContactName>
                                                            <CommunicationValue CommunicationType = '"Telephone"'>Left(EYJ->EYJ_CTTEL,35)</CommunicationValue>
                                                        </ContactInformation>
                                                    </EmergencyResponseContact>
                                                </IF_06>
                                            </HazardousGoods>
                                        </IF_03>
                                    </IF_05>
                                </GoodsDetails>
                            </FOR>
                        </MessageDetails>
                    </MessageBody>
                </Message>
            </XML>
        </DATA_SELECTION>
        <DATA_SEND>
            <SEND>''</SEND>
            <IF COND = "!Empty(EEC->EEC_PREEMB)">
                <CMD>FRM103FLMan('SI', 3, #TAG XML#, EEC->EEC_PREEMB, cNomFile)</CMD>
            </IF>
        </DATA_SEND>
        <DATA_RECEIVE>
            <SRV_STATUS>.T.</SRV_STATUS>
        </DATA_RECEIVE>
    </SERVICE>
</EASYLINK>

